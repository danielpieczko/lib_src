#include <xcore/parallel.h>
#include <xcore/hwtimer.h>
#include <xs1.h>
#include <stdlib.h>
#include <stdio.h>
#include <print.h>
#include <platform.h>
#include <xscope.h>

#include <string.h>

#include "src.h"


int fs_code(int frequency) {
    if(frequency == 44100) {
        return  FS_CODE_44;
    } else if(frequency == 48000) {
        return  FS_CODE_48;
    } else if(frequency == 88200) {
        return  FS_CODE_88;
    } else if(frequency == 96000) {
        return  FS_CODE_96;
    } else if(frequency == 176400) {
        return  FS_CODE_176;
    } else if(frequency == 192000) {
        return  FS_CODE_192;
    } else {
        printf("Illegal freq %d\n", frequency);
        exit(1);
    }
}


#define     SRC_N_CHANNELS                (1)   // Total number of audio channels to be processed by SRC (minimum 1)
#define     SRC_N_INSTANCES               (1)   // Number of instances (each usually run a logical core) used to process audio (minimum 1)
#define     SRC_CHANNELS_PER_INSTANCE     (SRC_N_CHANNELS/SRC_N_INSTANCES) // Calculated number of audio channels processed by each core
#define     SRC_N_IN_SAMPLES              (4)   // Number of samples per channel in each block passed into SRC each call
                                                // Must be a power of 2 and minimum value is 4 (due to two /2 decimation stages)
#define     SRC_N_OUT_IN_RATIO_MAX        (5)   // Max ratio between samples out:in per processing step (44.1->192 is worst case)
#define     SRC_DITHER_SETTING            (0)   // Enables or disables quantisation of output with dithering to 24b
#define     SRC_MAX_NUM_SAMPS_OUT         (SRC_N_OUT_IN_RATIO_MAX * SRC_N_IN_SAMPLES)
#define     SRC_OUT_BUFF_SIZE             (SRC_CHANNELS_PER_INSTANCE * SRC_MAX_NUM_SAMPS_OUT) // Size of output buffer for SRC for each instance

/* Stuff that must be defined for lib_src */
#define ASRC_N_IN_SAMPLES                 (SRC_N_IN_SAMPLES) /* Used by SRC_STACK_LENGTH_MULT in src_mrhf_asrc.h */

#define ASRC_N_CHANNELS                   (SRC_CHANNELS_PER_INSTANCE) /* Used by SRC_STACK_LENGTH_MULT in src_mrhf_asrc.h */



int32_t sine_wave[16] = {
    0,
    6420362,
    11863283,
    15500126,
    16777216,
    15500126,
    11863283,
    6420362,
    0,
    -6420362,
    -11863283,
    -15500126,
    -16777216,
    -15500126,
    -11863283,
    -6420362,
};

int32_t sine2_wave[19] = {
    0,
    5447553,
    10304779,
    14045322,
    16263837,
    16719913,
    15364126,
    12343398,
    7985072,
    2761438,
    -2761438,
    -7985072,
    -12343398,
    -15364126,
    -16719913,
    -16263837,
    -14045322,
    -10304779,
    -5447553,
};



int expected_wave_192_176[] = {
    0, 0, -1, 0, 1, -113, -1666, -4125,
    -3173, -6060, -2355, -2794, -2629, 7180, -8051, 20960,
    -17509, 29082, -20493, 16435, 1817, -34651, 74278, -152720,
    260250, -557782, 2276461, 9597719, 14249465, 16664195, 16016233, 12413262,
    6715529, -348775, -7202070, -12880910, -16154368, -16575819, -13987774, -8890073,
    -2197458, 4900273, 11106279, 15321643, 16775586, 15213034, 10913009, 4647555,
    -2454378, -9114697, -14135009, -16612012, -16100020, -12691156, -6998773, -47105,
    6913040, 12629323, 16073214, 16625055, 14185553, 9193648, 2547531, -4556961,
    -10841522, -15175370, -16778717, -15363074, -11183157, -4991055, 2099083, 8811536,
    13938529, 16557567, 16197405, 12922847, 7323084, 405680, -6584718, -12390330,
    -15966552, -16669916, -14373867, -9491531, -2901385, 4210804, 10565347, 15018866,
    16770046, 15503794, 11447948, 5332274,
};

int expected_wave_48_192[] = {
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, -1, -1, -1, -1, -1,
    -1, -1, -1, 2, 13, 41, 97, 185,
    299, 414, 486, 463, 301, -15, -455, -945,
    -1391, -1713, -1886, -1957, -2028, -2213, -2575, -3080,
    -3598, -3955, -4023, -3795, -3411, -3103, -3082, -3408,
    -3938, -4368, -4382, -3834, -2855, -1827, -1199, -1247,
    -1885, -2662, -2972, -2382, -904, 938, 2344, 2656,
    1757, 210, -979, -883, 791, 3455, 5860, 6738,
    5533, 2809, 58, -1052, 377, 3856, 7634, 9566,
    8313, 4206, -751, -3864, -3231, 1067, 6802, 10661,
    10059, 4711, -2956, -8937, -9802, -4750, 3673, 10714,
    11955, 5914, -4814, -14661, -18032, -12547, -717, 11049,
    15800, 10024, -3997, -18979, -26400, -21323, -5590, 12642,
    23053, 18956, 1490, -20336, -34165, -31155, -11422, 15232,
    34128, 33783, 12854, -18179, -42013, -43941, -20618, 16954,
    48473, 55236, 31137, -12587, -52199, -64009, -38127, 14400,
    65828, 86066, 59886, -2594, -68910, -100495, -74335, 1734,
    89597, 138905, 114555, 19259, -102215, -182096, -164746, -40915,
    137795, 275350, 275214, 94074, -219449, -521511, -611045, -296565,
    534410, 1871927, 3584412, 5463430, 7293626, 8919129, 10280497, 11410273,
    12393566, 13314391, 14212496, 15068032, 15816964, 16385710, 16726069, 16833629,
    16742845, 16504109, 16156361, 15709499, 15144350, 14428298, 13536876, 12469614,
    11252491, 9927018, 8532858, 7093593, 5612728, 4080995, 2490056, 844740,
    -832567, -2507084, -4142885, -5713844, -7208595, -8627445, -9973650, -11244206,
    -12425158, -13493613, -14424897, -15200679, -15813719, -16267026, -16568377, -16723516,
    -16731783, -16586319, -16278364, -15803026, -15163313, -14370421, -13440401, -12389249,
    -11229129, -9967593, -8609909, -7162935, -5638298, -4053167, -2428356, -784923,
    858888, 2488835, 4093622, 5662431, 7182557, 8638465, 10012713, 11288151,
    12450197, 13488032, 14394262, 15163406, 15790189, 16268580, 16592054, 16754849,
    16753474, 16587679, 16260423, 15776973, 15143673, 14367050, 13453662, 12410656,
    11246627, 9972270, 8600436, 7145593, 5622960, 4047749, 2434810, 798751,
    -845659, -2483117, -4097719, -5673260, -7193786, -8644161, -10010423, -11279856,
    -12440833, -13482608, -14395222, -15169608, -15797866, -16273581, -16592052, -16750368,
    -16747317, -16583223, -16259803, -15780102, -15148533, -14370949, -13454706, -12408638,
    -11242947, -9969029, -8599272, -7146898, -5625826, -4050590, -2436257, -798329,
    847396, 2484992, 4098598, 5672608, 7191836, 8641670, 10008192, 11278292,
    12439780, 13481494, 14393407, 15166731, 15794008, 16269189, 16587692, 16746446,
    16743922, 16580145, 16256691, 15776677, 15144726, 14366922, 13450757, 12405055,
    11239884, 9966467, 8597067, 7144873, 5623870, 4048707, 2434551, 796950,
    -848326, -2485432, -4098603, -5672301, -7191373, -8641187, -10007783, -11277997,
    -12439599, -13481399, -14393367, -15166719, -15794008, -16269191, -16587694, -16746448,
    -16743924, -16580147, -16256694, -15776680, -15144728, -14366924, -13450759, -12405057,
    -11239886, -9966469, -8597069, -7144875, -5623872, -4048709, -2434553, -796952,
    848324, 2485430, 4098601, 5672299, 7191371, 8641185, 10007781, 11277995,
    12439597, 13481397, 14393365, 15166717, 15794006, 16269189, 16587692, 16746446,
    16743922, 16580145, 16256692, 15776678, 15144726, 14366922, 13450757, 12405055,
    11239884, 9966467, 8597067, 7144873, 5623870, 4048707, 2434551, 796950,
    -848326, -2485432, -4098603, -5672301, -7191373, -8641187, -10007783, -11277997,
    -12439599, -13481399, -14393367, -15166719, -15794008, -16269191, -16587694, -16746448,
};


int expected_wave_192_44[] = {
    0, 0, -1, -1, 0, -2, -2, -3,
    16, 746, 3010, -327, -4127, 3013, 1099, -315,
    -4943, 6579, -2719, 826, -4738, 7900, -4513, -682,
    761, 1204, 2791, -12176, 19053, -22130, 29257, -44290,
    60849, -73853, 88921, -113628, 145772, -179262, 218021, -275299,
    362385, -501559, 730165, -1324576, 9247601, 12607227, -13434121, -8306100,
    15320089, 4349036, -16727914, 426458, 16512343, -4936645, -15181087, 9156141,
    12645649, -12669857, -9117130, 15169571, 4944364, -16568342, -326669, 16630710,
    -4252908, -15476423, 8559487, 13088374, -12169464, -9730069, 14873326, 5604137,
    -16420289, -1060192, 16716018, -3570238, -15726783, 7925388, 13531770, -11669330,
    -10298785, 14521492, 6277267, -16259892, -1774333, 16751264, -2864686, -15957935,
    7283997, 13940737, -11144682, -10854384, 14150640, 6935570, -16071347, -2484851,
    16759487, -2156445, -16162294, 6632350, 14325559, -10599606, -11390159, 13753939,
    7581205, -15853445, -3190832, 16737095, -1444264, -16337131, 5968588, 14684215,
    -10035168, -11905127, 13332114,
};

int expected_wave_44_192[] = {
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, -1, -1, -1, -1,
    -1, -1, -1, -1, 0, 4, 17, 47,
    101, 182, 286, 393, 473, 485, 390, 167,
    -179, -610, -1058, -1451, -1731, -1886, -1952, -2010,
    -2151, -2435, -2861, -3351, -3779, -4015, -3989, -3731,
    -3372, -3100, -3073, -3343, -3816, -4268, -4441, -4159,
    -3428, -2457, -1588, -1151, -1301, -1920, -2638, -2978,
    -2579, -1387, 277, 1825, 2652, 2430, 1301, -136,
    -1063, -817, 762, 3194, 5519, 6708, 6162, 4053,
    1325, -685, -860, 1125, 4557, 7924, 9572, 8504,
    4940, 328, -3236, -3975, -1334, 3625, 8588, 11007,
    9327, 3851, -3237, -8764, -10034, -6197, 1166, 8598,
    12301, 9965, 2048, -8213, -16139, -17785, -11942, -962,
    10088, 15688, 12539, 1372, -13071, -24031, -25883, -16994,
    -856, 15206, 23319, 18883, 3099, -17144, -32194, -34148,
    -20879, 2443, 25299, 36544, 29834, 7137, -21552, -42458,
    -44476, -24859, 8731, 41104, 56358, 45636, 12089, -29618,
    -59482, -61518, -31988, 17626, 64815, 86046, 68230, 16205,
    -47792, -93206, -95278, -47856, 31432, 106979, 140426, 109108,
    19259, -92960, -174677, -179446, -90874, 64142, 220145, 296495,
    232074, 18394, -282586, -544808, -608789, -327424, 388511, 1541124,
    3042898, 4741817, 6465172, 8066626, 9460569, 10633127, 11628267, 12516554,
    13359762, 14184828, 14975693, 15683816, 16250764, 16632262, 16813692, 16811630,
    16662406, 16403966, 16059516, 15629771, 15096286, 14433303, 13622085, 12661216,
    11568657, 10375411, 9114291, 7809214, 6469694, 5092516, 3669212, 2195451,
    677941, -864108, -2403219, -3911271, -5366849, -6759055, -8086387, -9351620,
    -10555333, -11691190, -12744987, -13697661, -14530636, -15230913, -15793655, -16221304,
    -16519911, -16694564, -16746091, -16670428, -16460754, -16111210, -15620391, -14993031,
    -14239245, -13371847, -12403081, -11342287, -10195449, -8966662, -7660671, -6285205,
    -4852042, -3376360, -1874790, -363095, 1145475, 2640515, 4113478, 5555973,
    6958222, 8308395, 9593102, 10798751, 11913141, 12926571, 13832057, 14624658,
    15300331, 15854889, 16283546, 16581228, 16743435, 16767259, 16652066, 16399593,
    16013460, 15498373, 14859384, 14101542, 13230010, 12250548, 11170089, 9997104,
    8741603, 7414761, 6028355, 4594226, 3123981, 1628985, 120586, -1389608,
    -2889542, -4366773, -5808728, -7203084, -8538134, -9803018, -10987767, -12083217,
    -13080858, -13972746, -14751520, -15410548, -15944126, -16347681, -16617895, -16752718,
    -16751303, -16613894, -16341729, -15936992, -15402829, -14743399, -13963921, -13070680,
    -12070994, -10973110, -9786081, -8519642, -7184104, -5790271, -4349386, -2873078,
    -1373304, 137742, 1647726, 3144302, 4615240, 6048538, 7432533, 8755992,
    10008192, 11178992, 12258907, 13239176, 14111837, 14869791, 15506870, 16017885,
    16398677, 16646146, 16758278, 16734162, 16573994, 16279077, 15851808, 15295661,
    14615158, 13815831, 12904180, 11887615, 10774401, 9573589, 8294942, 6948856,
    5546274, 4098601, 2617605, 1115327, -396018, -1904144, -3396789, -4861817,
    -6287317, -7661702, -8973795, -10212929, -11369031, -12432700, -13395288, -14248971,
    -14986807, -15602798, -16091936, -16450244, -16674808, -16763803, -16716505, -16533298,
    -16215673, -15766211, -15188568, -14487439, -13668525, -12738483, -11704875, -10576105,
    -9361349, -8070482, -6714002, -5302936, -3848756, -2363285, -858600, 653066,
    2159422, 3648221, 5107360, 6524975, 7889541, 9189964, 10415671, 11556696,
    12603763, 13548359, 14382804, 15100315, 15695058, 16162198, 16497936, 16699542,
    16765379, 16694909, 16488707, 16148449, 15676900, 15077897, 14356307, 13517998,
    12569786, 11519378, 10375317, 9146901, 7844120, 6477565, 5058345, 3598001,
    2108404, 601666, -909964, -2414195, -3898799, -5351705, -6761101, -8115528,
    -9403975, -10615965, -11741645, -12771864, -13698245, -14513257, -15210274, -15783629,
    -16228660, -16541749, -16720351,
};

int expected_wave_176_96[] = {
    0, 0, 0, 0, 1, -2, -308, -2475,
    -4310, -2295, -2158, 3608, 1786, 5160, 1310, -2526,
    1545, -12986, 11996, -20880, 29935, -29605, 41328, -39092,
    36380, -33940, 10771, 12125, -65728, 147815, -330104, 7124569,
    15952136, 15562798, 8133531, -3811217, -13563344, -16730400, -11465982, -517471,
    10679509, 16587689, 14179791, 4754238, -7088522, -15357873, -16002337, -8648576,
    3003221, 13164547, 16761619, 12002607, 1262528, -10109086, -16439615, -14577383,
    -5449964, 6394050, 15050763, 16204968, 9281319, -2268878, -12688087, -16782537,
    -12511223, -2003311, 9503207, 16272574, 14930383, 6145696, -5702498, -14708108,
    -16382019, -9889817, 1532265, 12190540, 16772075, 12993068, 2737275, -8882995,
    -16075267, -15254337, -6829422, 4999820, 14336759, 16527105, 10479020, -792645,
    -11669195, -16728880, -13449553, -3465886, 8245452, 15846601, 15548534, 7499834,
    -4287382, -13937428, -16639936, -11047772, 51493, 11125084, 16653045, 13879797,
    4187744, -7591814, -15587003, -15812381, -8155603
};

int expected_wave_192_88[] = {
    0, 0, 0, 1, 0, -361, -3176, -5381,
    -625, -1199, 6792, 2673, -373, 4462, -18816, 19518,
    -31278, 40355, -32511, 30770, -8510, -33867, 83886, -179601, 
    328160, -700420, 5116585, 15759296, 14866902, 3984726, -9627695, -16760609,
    -12178056, 570522, 13110113, 16493610, 8641334, -5210262, -15454199, -15079107,
    -4349123, 9384566, 16654345, 12486627, -269152, -12837921, -16582663, -8932605,
    4856576, 15307603, 15237043, 4693387, -9076240, -16607362, -12723503, -94216,
    12599833, 16633459, 9234174, -4512170, -15157094, -15383875, -5036634, 8772514,
    16551921, 12954464, 452829, -12360051, -16677320, -9531524, 4165715, 14999673,
    15523693, 5377591, -8464768, -16488913, -13179494, -811224, 12114638, 16713572,
    9824530, -3817348, -14835393, -15656411, -5716081, 8153166, 16418379, 13398517,
    1169258, -11863680, -16742187, -10113040,
};

int expected_wave_176_88[] = {
    0, 0, 0, 0, 3, -87, -1570, -5144,
    -3576, -1711, 1509, 6747, -213, 8484, -11765, 6941,
    -15964, 8022, -1463, -2162, 26382, -41807, 68070, -108036,
    140369, -199710, 279323, -492885, 2184572, 12873131, 16805447, 10494906,
    -1597643, -13101062, -16620595, -10664538, 1744615, 12980531, 16713697, 10597571,
    -1700694, -13005577, -16702856, -10598741, 1696188, 13012597, 16695557, 10604984,
    -1700779, -13009652, -16697001, -10606586, 1696162, 13005292, 16696102, 10606564,
    -1696158, -13005288, -16696099, -10606560, 1696158, 13005291, 16696102, 10606564,
    -1696158, -13005288, -16696099, -10606560, 1696158, 13005291, 16696102, 10606564,
    -1696158, -13005288, -16696099, -10606560, 1696158, 13005291, 16696102, 10606564,
    -1696158, -13005288, -16696099, -10606560, 1696158, 13005291, 16696102, 10606564,
    -1696158, -13005288, -16696099, -10606560, 1696158, 13005291, 16696102, 10606564,
    -1696158, -13005288, -16696099, -10606560,
};

int expected_wave_88_48[] = {
    0, 0, 0, 0, 0, -9, -272, -1210,
    -1426, -915, -117, 1159, 1069, 1736, -396, 400,
    -2685, 351, -2803, 2786, -1740, 4702, -2586, 3898,
    -4834, 2464, -4823, 2594, -1519, 2062, 2495, -2835,
    6599, -12076, 14766, -23884, 31154, -41354, 58115, -75616,
    107876, -161028, 243857, -492038, 6463944, 15661472, 15803384, 8796628,
    -3105881, -13079742, -16829799, -11954512, -1310312, 10140840, 16412849, 14602981,
    5434697, -6380689, -15063090, -16201091, -9289096, 2271268, 12687900, 16786415,
    12514505, 2004286, -9502982, -16276520, -14932508, -6149238, 5703560, 14709268,
    16386256, 9891972, -1530747, -12192407, -16774893, -12996503, -2738887, 8883551,
    16078002, 15257716, 6831009, -5000978, -14340084, -16530940, -10481452, 792834,
    11671908, 16732768, 13452676, 3466697, -8247363, -15850277, -15552142, -7501571,
    4288383, 13940665, 16643804, 11050338, -51502, -11127665, -16656907, -13883017,
    -4188712, 7593580, 15590626, 15816054, 8157497,
};

int expected_wave_96_48[] = {
    0, 0, 0, -1, 0, 62, 545, 9,
    -2957, -3466, -3439, 33, 1880, 4114, 2771, 298,
    -1744, -5003, -816, -3694, 7033, -2674, 11450, -10515,
    11444, -20782, 17778, -25301, 31855, -30931, 43398, -46506,
    52020, -66814, 70800, -88144, 110114, -136656, 202911, -403858,
    2073791, 12977543, 16695793, 10601304, -1681800, -13020521, -16677600, -10629024,
    1715725, 12982523, 16717930, 10587842, -1674848, -13022124, -16680305, -10622929,
    1707046, 12993079, 16706112, 10600392, -1687661, -13009432, -16692553, -10611388,
    1696389, 13002704, 16697601, 10607754, -1693903, -13004313, -16696731, -10608323,
    1693629, 13003518, 16693630, 10604771, -1695864, -13003061, -16693240, -10604744,
    1695869, 13003067, 16693245, 10604748, -1695865, -13003061, -16693240, -10604744,
    1695869, 13003067, 16693245, 10604748, -1695865, -13003061, -16693240, -10604744,
    1695869, 13003067, 16693245, 10604748,
};

int unit_test_spline() {
//    int DWORD_ALIGNED iH[3] = {0x12345678, 0x87654321, -12314516};
    int DWORD_ALIGNED iH[3] = { -12314516, 0x87654321,0x12345678};
    int           *piPhase0 = &iADFirCoefs[0][63];
    int DWORD_ALIGNED piADCoefs1[16];
    int out63[16] = {
        0xffffde68,
        0xfff9c91a,
        0x001fb061,
        0x00387050,
        0xfe1347a3,
        0x054d01a1,
        0xf7101d35,
        0xd71ca2dd,
        0xf6dd5890,
        0x05573f10,
        0xfe13e0a5,
        0x0036b73e,
        0x00205038,
        0xfff9bbd0,
        0xffffdd51,
        0x00000000        
    };
    ASRC_prepare_coefs();
    src_mrhf_spline_coeff_gen_inner_loop_asm_xs3(piPhase0, iH, piADCoefs1, FILTER_DEFS_ADFIR_PHASE_N_TAPS);
//    src_mrhf_spline_coeff_gen_inner_loop_asm(piPhase0, iH, piADCoefs2, FILTER_DEFS_ADFIR_PHASE_N_TAPS);

    int errors = 0;
    for(int i =0 ; i < 16; i++) {
        if (abs(piADCoefs1[i] - out63[i]) > 2) {
            printf("%08x should be 0x%08x,\n", piADCoefs1[i], out63[i]);
            errors++;
        }
    }

    printf("Spline done\n");
    return errors;
}



int unit_test_asrc(int test_case) {
    int input_frequency;
    int output_frequency;
    int *expected_wave;
    int steps = 100;
    int old_time = 0;
    if (test_case == 0) {
        old_time = 124751;
        input_frequency = 48000;
        output_frequency = 192000;
        expected_wave = expected_wave_48_192;   // 6 OS2 UP_N_TAPS FILTER_DEFS_ASRC_FIR_UP_ID
    } else if (test_case == 1) {
        old_time = 50695;
        input_frequency = 192000;
        output_frequency = 176400;
        expected_wave = expected_wave_192_176;  // 9 FILTER_DEFS_ASRC_FIR_UP192176_ID
    } else if (test_case == 2) {
        old_time = 163022;
        input_frequency = 192000;
        output_frequency = 44100;
        expected_wave = expected_wave_192_44;   // 10 FILTER_DEFS_ASRC_FIR_DS_ID,           1  FILTER_DEFS_ASRC_FIR_BL9644_ID
        steps = 500;
    } else if (test_case == 3) {
        old_time = 132734;
        input_frequency = 44100;
        output_frequency = 192000;
        expected_wave = expected_wave_44_192;   // 6 FILTER_DEFS_ASRC_FIR_UP_ID
    } else if (test_case == 4) {
        old_time = 79768;
        input_frequency = 176400;
        output_frequency = 96000;
        expected_wave = expected_wave_176_96;   // 5 FILTER_DEFS_ASRC_FIR_BL17696_ID
        steps = 200;
    } else if (test_case == 5) {
        old_time = 76162;
        input_frequency = 192000;
        output_frequency = 88200;
        expected_wave = expected_wave_192_88;   // 4 FILTER_DEFS_ASRC_FIR_BL19288_ID
        steps = 200;
    } else if (test_case == 6) {
        old_time = 77709;
        input_frequency = 176400;
        output_frequency = 88200;
        expected_wave = expected_wave_176_88;   // 3 FILTER_DEFS_ASRC_FIR_BLF_ID
        steps = 200;
    } else if (test_case == 7) {
        old_time = 97773;
        input_frequency = 88200;
        output_frequency = 48000;
        expected_wave = expected_wave_88_48;   // 2 FILTER_DEFS_ASRC_FIR_BL8848_ID
        steps = 200;
    } else if (test_case == 8) {
        old_time = 95707;
        input_frequency = 96000;
        output_frequency = 48000;
        expected_wave = expected_wave_96_48;   // 0 FILTER_DEFS_ASRC_FIR_BL_ID
        steps = 200;
    } else {
        printf("Bad test case %d\n", test_case);
        return 1;
    }

    asrc_state_t sASRCState[SRC_CHANNELS_PER_INSTANCE];                                   // ASRC state machine state
    int iASRCStack[SRC_CHANNELS_PER_INSTANCE][ASRC_STACK_LENGTH_MULT * SRC_N_IN_SAMPLES * 100]; // Buffer between filter stages
    asrc_ctrl_t sASRCCtrl[SRC_CHANNELS_PER_INSTANCE];                                     // Control structure
    asrc_adfir_coefs_t asrc_adfir_coefs;                                                  // Adaptive filter coefficients

    uint64_t fs_ratio = 0;
    int sine_cnt = 0;

    int inputFsCode = fs_code(input_frequency);
    int outputFsCode = fs_code(output_frequency);

    for(int ui = 0; ui < SRC_CHANNELS_PER_INSTANCE; ui++)
    {
            // Set state, stack and coefs into ctrl structure
            sASRCCtrl[ui].psState                   = &sASRCState[ui];
            sASRCCtrl[ui].piStack                   = iASRCStack[ui];
            sASRCCtrl[ui].piADCoefs                 = asrc_adfir_coefs.iASRCADFIRCoefs;
    }

    fs_ratio = asrc_init(inputFsCode, outputFsCode, sASRCCtrl, SRC_CHANNELS_PER_INSTANCE, SRC_N_IN_SAMPLES, SRC_DITHER_SETTING);

    int in_samples[4];
    int out_samples[20];
    int exp_cnt = 0;
    int errors = 0;
    int total_time = 0, t0, t1;
    for(int32_t i = 0; i < steps; i+=4) {
        for(int j = 0; j < 4; j++) {
            in_samples[j] = sine_wave[sine_cnt];
            sine_cnt++;
            if (sine_cnt == 16) sine_cnt = 0;
        }
        asm volatile("gettime %0" : "=r" (t0));
        int num_samples = asrc_process(in_samples, out_samples, fs_ratio, sASRCCtrl);
        asm volatile("gettime %0" : "=r" (t1));
        total_time += t1-t0;
        for(int j = 0; j < num_samples; j++) {
            if (abs(out_samples[j] - expected_wave[exp_cnt]) > 8) {
                printf("saw %d expected %d\n", out_samples[j], expected_wave[exp_cnt]);
                errors++;
            }
            exp_cnt++;
        }
    }
    printf("%d -> %d: %d errors time %d old_time %d %f speedup\n", input_frequency, output_frequency, errors, total_time, old_time, old_time / (float) total_time);
    return errors;
}

#define LOCAL_SRC_CHANNELS_PER_INSTANCE 2
int expected_wave_stereo_96_48[] = {
0, 0, 0, 0, 0, 0, -1, -1,
-1, -1, 60, 51, 539, 472, 23, 112,
-2942, -2391, -3471, -3266, -3447, -4040, -18, -1913,
1883, -309, 4062, 2614, 2857, 3572, 249, 3245,
-1596, 2357, -5148, -1833, -665, -871, -3964, -6654,
7236, 956, -2955, -6747, 11772, 8532, -10742, -6138,
11752, 15392, -20977, -11519, 17837, 17852, -25319, -22353,
31507, 20730, -30334, -31846, 42396, 30288, -44784, -37465,
49650, 45267, -63302, -45603, 65781, 60319, -81216, -64888,
99921, 80054, -121486, -106157, 178543, 141030, -354210, -297862,
1786584, 1496460, 12612454, 11030652, 16768508, 16513152, 10970636, 14920250,
-1145903, 7127965, -12689121, -3747827, -16713685, -12961425, -11063455, -16803880,
1155200, -13486919, 12601750, -4575587, 16771932, 6342434, 11045964, 14514085,
-1057222, 16646752, -12617928, 11705714, -16731093, 1896260, -11121589, -8764753,
1045811, -15688992, 12554689, -16049047, 16761793, -9617925, 11133255, 833127,
-978281, 10957367, -12539922, 16449437, -16750965, 15031600, -11179536, 7274114,
939315, -3537199, 12501988, -12865370, 16758211, -16773418, 11211696, -13622451,
-889876, -4735375, -12471523, 6144829, -16760187, 14437964, -11247257, 16653276,
842018, 11856977, 12439149, 2069259, 16759502, -8591764, 11278901, -15635936,
-797072, -16097238, -12406898, -9781768, -16761331, 651707, -11313952, 10810822,
749678, 16418710, 12374906, 15114516, 16763448, 7447292, 11348940, -3355153,
-702283, -12745120, -12342820, -16769544, -16765436, -13734190, -11383840, -4916907,
654878, 5970334, 12310631, 14344136, 16767286, 16679228, 11418646, 11992564,
-607471, 2257173, -12278347, -8428461, -16769005, -15565814, -11453364, -16150147,
560056, -9935460, 12245962, 461935, 16770587, 10664861, 11487987, 16378008,
};

int expected_wave_stereo_176_176[] = {
0, 0, 0, 0, -1, -1, 0, 0,
1, 1, -14, -12, -667, -566, -3217, -2755,
-3711, -3316, -4612, -4343, -5465, -5452, -1683, -2745,
-6270, -7059, 4923, 1972, -6179, -7492, 10918, 6982,
-3466, -4601, 9268, 6876, 5902, 5144, -7013, -4486,
26868, 25169, -41349, -31059, 62687, 56891, -91948, -72704,
114132, 99765, -156050, -127934, 186621, 158070, -275388, -231709,
517502, 432823, 7015813, 5958157, 12389823, 10789692, 15660392, 14266946,
16845823, 16451024, 15163835, 16594781, 11461971, 15184896, 5774700, 11925805,
-596014, 7541394, -7019586, 2219513, -12279899, -3260589, -15730717, -8436085,
-16765112, -12677124, -15255954, -15550456, -11437111, -16749101, -5865387, -16123418,
582016, -13766937, 6954414, -9909849, 12260184, -4989071, 15708704, 476424,
16767183, 5888023, 15278195, 10663253, 11467956, 14285511, 5912985, 16360825,
-540964, 16666031, -6912706, 15168428, -12233920, 12030023, -15695939, 7590303,
-16772638, 2329521, -15300388, -3183250, -11502931, -8351682, -5957368, -12616693,
493540, -15516927, 6869444, -16738661, 12201394, -16149732, 15679093, -13813850,
16774031, -9983694, 15319809, -5073577, 11537428, 385361, 6001697, 5802613,
-446114, 10592182, -6826130, 14235970, -12168775, 16339821, -15662125, 16676156,
-16775294, 15208590, -15339111, 12095877, -11571836, 7674725, -6045983, 2423379,
398681, -3090108, 6782758, -8269333, 12136055, -12554044, 15645029, -15480755,
16776420, -16732878, 15358287, -16174965, 11606148, -13867369, 6090216, -10059709,
-351249, -5163866, -6739335, 290565, -12103241, 5713564, -15627811, 10518513,
-16777415, 14185650, -15377344, 16318292, -11640371, 16685748, -6134405, 15248265,
303810, 12161344, 6695855, 7758901, 12070327, 2517159, 15610464, -2996868,
16778272, -8186719, 15396274, -12490993, 11674497, -15444087, 6178540, -16726560,
-256373, -16199680, -6652325, -13920444, -12037320, -10135402, -15592997, -5253989,
-16778999, 195759, -15415085, 5624332, -11708534, 10444508, -6222630, 14134876,
208929, 16296242, 6608738, 16694807, 12004213, 15287453, 15575401, 12226422,
16779587, 7842829, 15433769, 2610859, 11742473, -2903532, 6266667, -8103844,
-161488, -12427543, -6565102, -15406926, -11971014, -16719707, -15557684, -16223877,
-16780046, -13973073, -15452333, -10210771, -11776322, -5343945, -6310657, 100948,
114042, 5534921, 6521410, 10370168, 11937715, 14083650, 15539839, 16273671,
16780366, 16703332, 15470770, 15326152, 11810073, 12291108, 6354592, 7926507,
-66599, 2704476, -6477669, -2810104, -11904325, -8020709, -15521874, -12363695,
-16780557, -15369272, -15489087, -16712320, -11843733, -16247555, -6398480, -14025255,
19153, -10285812, 6433875, -5433728, 11870837, 6135, 15503781, 5445333,
16780609, 10295497, 15507278, 14031973, 11877298, 16250579, 6442318, 16711324,
28296, 15364362, -6390027, 12355404, -11837254, 8009932, -15485567, 2798007,
-16780531, -2716584, -15525346, -7937317, -11910767, -12299451, -6486103, -15331126,
-75742, -16704398, 6346129, -16270714, 11803576, -14076991, 15467226, -10360528,
16780315, -5523342, 15543288, -88683, 11944139, 5355569, 6529833, 10220497,
123185, 13979848, -6302184, 16226968, -11769807, 16718779, -15448766, 15402079,
-16779969, 12419302, -15561108, 8093100, -11977419, 2891447, -6573515, -2622979,
-170631, -7853672, 6258184, -12234815, 11735939, -15292490, 15430178, -16695942,
16779484, -16293353, 15578801, -14128275, 12010600, -10434910, 6617141, -5612776,
218072, -183494, -6214138, 5265636, -11701982, 10145170, -15411470, 13927276,
-16778870, 16202838, -15596373, 16725701, -12043688, 15439305, -6660718, 12482804,
-265515, 8176009, 6170038, 2984795, 11667928, -2529289, 15392635, -7769776,
16778117, -12169788, 15613816, -15253365, 12076677, -16686952, 6704238, -16315471,
312952, -14179108, -6125893, -10508959, -11633784, -5702031, -15373682, -278301,
-16777234, 5175534, -15631139, 10069518, -12109572, 13874259, -6747708, 16178190,
-360390, 16732089, 6081696, 15476036, 11599543, 12545906, 15354601, 8258657,
16776213, 3078048, 15648333, -2435519, 12142367, -7685632, 6791120, -12104371,
407822, -15213753, -6037453, -16677429, -11565213, -16337067, -15335402, -14229487,
-16775062, -10582671, -15665405, -5791103, -12175069, -373098, -6834481, 5085266,
-455254, 9993545, 5993158, 13820798, 11530787, 16153024, 15316076, 16737941,
16773773, 15512273, 15682348, 12608608, 12207670, 8341040, 6877785, 3171202,
502679, -2341671, -5948819, -7601241, -11496273, -12038568, -15296631, -15173654,
-16772353, -16667372, -15699170, -16358140, -12240177, -14279411, -6921037, -10656046,
-550104, -5879991, 5904429, -467884, 11461662, 4994836, 15277060, 9917252,
16770796, 13766895, 15715863, 16127342, 12272582, 16743257, 6964230, 15548013,
597520, 12670906, -5859995, 8423157, -11426964, 3264255, -15257371, -2247748,
-16769108, -7516608, -15732433, -11972379, -12304893, -15133069, -7007371, -16656783,
-644935, -16378691, 5815511, -14328878, 11392171, -10729079, 15237556, -5968690,
16767283, -562654, 15748874, 4904246, 12337101, 9840642, 7050452, 13712552,
692342, 16101144, -5770984, 16748039, -11357291, 15583257, -15217624, 12732799,
-16765327, 8505005, -15765193, 3357204, -12369215, -2153753, -7093481, -7431734,
-739747, -11905807, 5726407, -15092001, 11322316, -16645660, 15197565, -16398717,
16763234, -14377888, 15781382, -10801770, 12401226, -6057199, 7136449, -657407,
787142, 4813499, -5681788, 9763717, -11287254, 13657770, -15177390, 16074431,
-16761010, 16752284, -15797449, 15618002, -12433142, 12794285, -7179364, 8586581,
-834534, 3450045, 5637120, -2059689, 11252098, -7346622, 15157088, -11838855,
16758649, -15050450, 15813386, -16634006, 12464955, -16418219, 7222218, -14426437,
881916, -10874115, -5592411, -6145514, -11216856, -752138, -15136670, 4722598,
-16756157, 9686480, -15829200, 13602551, -12496672, 16047204, -7265018, 16755994,
-929295, 15652248, 5547653, 12855362, 11181521, 8667882, 15116127, 3542776,
16753528, -1965559, 15844884, -7261276, 12528285, -11771524, 7307755, -15008418,
976663, -16621819, -5502854, -16437197, -11146100, -14474526, -15095467, -10946112,
-16750768, -6233632, -15860445, -846846, -12559802, 4631546, -7350439, 9608933,
-1024026, 13546898, 5458008, 16019464, 11110586, 16759169, 15074682, 15685993,
16747871, 12916027, 15875875, 8748906, 12591214, 3635394, 7393060, -1871366,
1071378, -7175697, -5413122, -11703817, -11074987, -14965906, -15053780, -16609101,
-16744843, -16455648, -15891182, -14522151, -12622530, -11017760, -7435625, -6321552,
-1118725, -941526, 5368189, 4540346, 11039296, 9531079, 15032755, 13490811,
16741678, 15991212, 15906358, 16761807, 12653741, 15719236, 7478127, 12976280,
1166059, 8829650, -5323217, 3727895, -11003520, -1777114, -15011613, -7089889,
-16738383, -11635735, -15921411, -14922916, -12684854, -16595852, -7520574, -16473574,
-1213387, -14569312, 5278198, -11089055, 10967653, -6409268, 14990347, -1036176,
16734951, 4449001, 15936333, 9452920, 12715863, 13434293, 7562956, 15962448,
1260702, 16763909, -5233141, 15751977, -10931701, 13036118, -14968965, 8910112,
-16731388, 3820277, -15951131, -1682805, -12746773, -7003855, -7605281, -11567281,
-1308011, -14879448, 5188038, -16582072, 10895659, -16490972, 14947460, -14616007,
16727688, -11159995, 15965798, -6496780, 12777578, -1130793, 7647542, 4357514,
1355305, 9374459, -5142898, 13377345, -10859533, 15933174, -14925839, 16765476,
-16723858, 15784214, -15980341, 13095539, -12808285, 8990289, -7689746, 3912537,
-1402593, -1588442, 5097713, -6917596, 10823316, -11498458, 14904094, -14835504,
16719890, -16567762, 15994753, -16507844, 12838885, -14662235, 7731884, -11230578,
1449865, -6584085, -5052491, -1225374, -10787017, 4265887, -14882235, 9295698,
-16715793, 13319970, -16009040, 15903391, -12869386, 16766506, -7773965, 15815947,
-1497130, 13154541, 5007224, 9070178, 10750628, 4004672, 14860253, -1494028,
16711558, -6831116, 16023196, -11429267, 12899781, -14791086, 7815979, -16552922,
1544379, -16524187, -4961922, -14707993, -10714157, -11300803, -14838156, -6671178,
-16707193, -1319916, -16037227, 4174124, -12930077, 9216640, -7857935, 13262169,
-1591619, 15873099, 4916576, 16767000, 10677596, 15847174, 14815936, 13213122,
16702691, 9149777, 16051127, 4096679, 12960265, -1399566, 7899824, -6744418,
1638843, -11359710, -4871194, -14746195, -10640954, -16537552, -14793602, -16540002,
-16698059, -14753282, -16064902, -11370666, -12990353, -6758059, -7941654, -1414416,
-1686058, 4082228, 4825770, 9137287, 10604222, 13203943, 14771145, 15842299,
16693290, 16766958, 16078544, 15877894, 13020334, 13271281, 7983416, 9229084,
1733255, 4188554, -4780311, -1305060, -10567410, -6657504, -14748574, -11289790,
-16688391, -14700833, -16092062, -16521654, -13050215, -16555288, -8025119, -14798099,
-1780442, -11440165, 4734810, -6844723, 10530510, -1508870, 14725882, 3990200,
16683355, 9057642, 16105448, 13145295, 13079987, 15810993, 8066753, 16766379,
1827611, 15908106, -4689274, 13329016, -10493529, 9308096, -14703076, 4280296,
-16678189, -1210512, -16118708, -6570377, -13109659, -11219509, -8108327, -14655000,
-1874769, -16505228, 4643698, -16570045, 10456460, -14842442, 14680148, -11509299,
16672887, -6931168, 16131836, -1603276, 13139222, 3898046, 8149833, 8977707,
1921909, 13086227, -4598088, 15779181, -10419312, 16765265, -14657107, 15937809,
-16667455, 13386324, -16144839, 9386810, -13168683, 4371901, -8191277, -1115925,
-1969037, -6483040, 4552438, -11148869, 10382076, -14608699, 14633945, -16488274,
16661885, -16584272, 16157709, -14886311, 13198036, -11578064, 8232651, -7017392,
2016145, -1697631, -4506755, 3805766, -10344762, 8897485, -14610669, 13026741,
-16656187, 15746865, -16170453, 16763614, -13227287, 15967003, -8273964, 13443204,
-2063242, 9465224, 4461032, 4463366, 10307361, -1021303, 14587273, -6395495,
16650351, -11077873, 16183064, -14561931, 13256429, -16470792, 8315206, -16597968,
2110317, -14929704, -4415278, -11646460, -10269881, -7103391, -14563765, -1791931,
-16644386, 3713365, -16195550, 8816979, -13285468, 12966838, -8356386, 15714045,
-2157380, 16761428, 4369484, 15995686, 10232315, 13499654, 14540136, 9543335,
16638284, 4554689, 16207903, -926647, 13314397, -6307747, 8397496, -11006523,
2204422, -14514697, -4323659, -16452784, -10194672, -16611134, -14516394, -14972619,
-16632054, -11714482, -16220130, -7189163, -13343224, -1886175, -8438542, 3620846,
-2251450, 8736191, 4277796, 12906520, 10156942, 15680722, 14492533, 16758705,
16625686, 16023858, 16232223, 13555673, 13371940, 9621141, 8479516, 4645866,
2298456, -831963, -4231902, -6219796, -10119136, -10934820, -14468560, -14466998,
-16619189, -16434250, -16244190, -16623769, -13400553, -15015056, -8520427, -11782131,
-2345447, -7274705, 4185971, -1980358, 10081245, 3528210, 14444467, 8655123,
16612555, 12845790, 16256024, 15646899, 13429055, 16755446, 8561266, 16051518,
2392416, 13611258, -4140010, 9698639, -10043277, 4736894, -14420262, -737251,
-16605793, -6131646, -16267731, -10862768, -13457454, -14418838, -8602040, -16415190,
-2439370, -16635872, 4094012, -15057013, 10005225, -11849402, 14395938, -7360015,
16598894, -2074477, 16279305, 3435462, 13485741, 8573779, 8642742, 12784649,
2486300, 15612574, -4047985, 16751652, -9967097, 16078664, -14371504, 13666408,
-16591866, 9775827, -16290752, 4827771, -13513924, -642516, -8683378, -6043301,
-2533215, -10790368, 4001922, -14370216, 9928885, -16395605, 14346950, -16647443,
16584701, -15098488, 16302066, -11916295, 13541996, -7445090, 8723941, -2168531,
2580105, 3342603, -3955831, 8492160, -9890598, 12723099, -14322286, 15577751,
-16577408, 16747322, -16313252, 16105296, -13569963, 13721121, -8764439, 9852703,
-2626978, 4918493, 3909705, -547761, 9852228, -5954762, 14297503, -10717624,
16569979, -14321134, 16324305, -16375496, 13597817, -16658481, 8804862, -15139480,
2673827, -11982807, -3863551, -7529926, -9813783, -2262514, -14272610, 3249638,
-16562421, 8410270, -16335231, 12661142, -13625567, 15542429, -8845219, 16742457,
-2720658, 16131413, 3817362, 13775396, 9775256, 9929263, 14247598, 5009058,
16554726, -452987, 16346022, -5866033, 13653204, -10644537, 8885501, -14271595,
2767463, -16354864, -3771147, -16668987, -9736654, -15179988, -14222477, -12048935,
-16546903, -7614521, -16356687, -2356426, -13680736, 3156569, -8925716, 8328111,
-2814251, 12598780, 3724897, 15506611, 9697971, 16737056, 14197238, 16157014,
16538944, 13829229, 16367217, 10005507, 13708154, 5099463, 8965856, -358200,
2861011, -5777116, -3678622, -10571109, -9659214, -14221599, -14171890, -16333708,
-16530857, -16678960, -16377620, -15220011, -13735467, -12114678, -9005928, -7698873,
-2907753, -2450262, 3632314, 3063399, 9620376, 8245685, 14146424, 12536015,
16522633, 15470296, 16387888, 16731120, 13762666, 16182098, 9045924, 13882621,
2954468, 10081429, -3585980, 5189705, -9581465, -263401, -14120850, -5688015,
-16514282, -10497343, -16398029, -14171149, -13789759, -16312030, -9085852, -16688400,
-3001163, -15259547, 3539614, -12180034, 9542473, -7782979, 14095158, -2544020,
16505794, 2970131, 16408035, 8162996, 13816737, 12472850, 9125703, 15433487,
3047830, 16724648, -3493223, 16206665, -9503410, 13935568, -14069358, 10157030,
-16497179, 5279781, -16417914, -168594, -13843609, -5598731, -9165485, -10423242,
-3094476, -14120245, 3446801, -16289830, 9464266, -16697306, 14043441, -15298595,
16488427, -12245000, 16427657, -7866835, 13870367, -2637696, 9205189, 2876768,
3141094, 8080046, -3400355, 12409286, -9425050, 15396184, -14017416, 16717642,
-16479548, 16230714, -16437274, 13988070, -13897017, 10232306, -9244825, 5369688,
-3187691, -73781, 3353878, -5509269, 9385756, -10348807, 13991275, -14068890,
16470533, -16267110, 16446754, -16705678, 13923553, -15337153, 9284382, -12309574,
3234258, -7950440, -3307378, -2731287, -9346391, 2783315, -13965027, 7996840,
-16461391, 12345326, -16456108, 15358391, -13949981, 16710103, -9323870, 16254244,
-3280806, 14040126, 3260844, 10307257, 9306943, 5459426, 13938660, 21037,
16452112, -5419629, 16465326, -10274041, 13976295, -14017084, 9363279, -16243869,
3327320, -16713516, -3214293, -15375222, -9267429, -12373756, -13912189, -8033793,
-16442706, -2824794, -16474416, 2689769, -14002500, 7913373, -9402616, 12280968,
-3373812, 15320103, 3167711, 16702027, 9227836, 16277253, 13885602, 14091731,
16433165, 10381874, 16483371, 5548985, 14028589, 115849, 9441875, -5329818,
3420274, -10198947, -3121108, -13964831, -9188173, -16220109, -13858907, -16720819,
-16423496, -15412799, -16492197, -12437541, -14054570, -8116886, -9481062, -2918208,
-3466712, 2596139, 3074475, 7829656, 9148433, 12216220, 13832098, 15281327,
16413693, 16693418, 16500888, 16299743, 14080434, 14142886, 9520169, 10456161,
3513119, 5638368, -3027822, 210660, -9108624, -5239836, -13805183, -10123527,
-16403761, -13912132, -16509451, -16195830, -14106190, -16727588, -9559204, -15449883,
-3559501, -12500929, 2981141, -8199721, 9068738, -3011529, 13778153, 2502426,
16393695, 7745689, 16517878, 12151080, 14131829, 15242062, 9598159, 16684275,
3605851, 16321711, -2934440, 14193588, -9028783, 10530114, -13751017, 5727571,
-16383502, 305464, -16526177, -5149686, -14157360, -10047783, -9637041, -13858987,
-3652176, -16171034, 2887711, -16733822, 8988752, -15486472, 13723767, -12563916,
16373174, -8282293, 16534340, -3104754, 14182773, 2408633, 9675842, 7661473,
3698468, 12085553, -2840963, 15202310, -8948653, 16674599, -13696411, 16343157,
-16362718, 14243837, -16542375, 10603730, -14208076, 5816591, -9714570, 400258,
-3744735, -5059371, 2794189, -9971718, 8908479, -13805399, 13668942, -16145720,
16352128, -16739520, 16550273, -15522567, 14233262, -12626502, 9753216, -8364601,
3790967, -3197880, -2747396, 2314763, -8868237, 7577013, -13641367, 12019638,
-16341412, 15162072, -16558043, 16664389, -14258339, 16364081, -9791788, 14293631,
-3837174, 10677007, 2700577, 5905424, 8827921, 495039, 13613679, -4968895,
16330560, -9895334, 16565677, -13751370, 14283297, -16119890, 9830278, -16744684,
3883345, -15558165, -2653741, -12688685, -8787537, -8446641, -13585887, -3290903,
-16319582, 2220819, -16573182, 7492310, -14308145, 11953340, -9868693, 15121349,
-3929490, 16653647, 2606880, 16384482, 8747080, 14342967, 13557982, 10749942,
16308470, 5994070, 16580551, 589805, 14332875, -4878260, 9907025, -9818633,
3975599, -13696901, -2560001, -16093544, -8706557, -16749312, -13529972, -15593266,
-16297231, -12750461, -16587791, -8528411, -14357494, -3383821, -9945282, 2126804,
-4021680, 7407368, 2513098, 11886659, 8665960, 15080142, 13501851, 16642372,
16285858, 16404358, 16594895, 14391845, 14381995, 10822534, 9983456, 6082523,
4067725, 684552, -2466179, -4787468, -8625298, -9741618, -13473625, -13641993,
-16274359, -16066684, -16601870, -16753404, -14406384, -15627868, -10021554, -12811830,
-4113742, -8609908, 2419237, -3476631, 8584563, 2032721, 13445288, 7322189,
16262726, 11819598, 16608708, 15038453, 14430655, 16630565, 10059567, 16423710,
4159722, 14440262, -2372279, 10894779, -8543763, 6170782, -13416847, 779277,
-16250966, -4696524, -16615417, -9664292, -14454813, -13586650, -10097505, -16039310,
-4205672, -16756960, 2325298, -15661971, 8502891, -12872790, 13388295, -8691130,
16239073, -3569330, 16621990, 1938573, 14478853, 7236776, 10135357, 11752159,
4251585, 14996283, -2278302, 16618226, -8461955, 16442537, -13359640, 14488218,
-16227054, 10966677, -16628434, 6258844, -14502780, 873977, -10173133, -4605429,
-4297468, -9586657, 2231284, -13530872, 8420947, -16011423, 13330874, -16759981,
16214901, -15695572, 16634741, -12933337, 14526588, -8772074, 10210823, -3661914,
4343313, 1844363, -2184253, 7151131, -8379876, 11684344, -13302006, 14953634,
-16202623, 16605356, -16640918, 16460837, -14550284, 14535710, -10248435, 11038223,
-4389127, 6346705, 2137200, 968649, 8338734, -4514188, 13273027, -9508715,
16190211, -13474662, 16646959, -15983024, 14573859, -16762466, 10285962, -15728672,
4434901, -12993471, -2090133, -8852738, -8297530, -3754382, -13243946, 1750094,
-16177673, 7065258, -16652871, 11616155, -14597322, 14910507, -10323410, 16591954,
-4480645, 16478612, 2043047, 14582738, 8256255, 11109417, 13214756, 6434363,
16165003, 1063290, 16658646, -4422801, 14620664, -9430469, 10360772, -13418021,
4526348, -15954114, -1995947, -16764415, -8214918, -15761268, -13185463, -13053189,
-16152207, -8933118, -16664291, -3846729, -14643893, 1655769, -10398055, 6979159,
-4572019, 11547596, 1948828, 14866902, 8173511, 16578022, 13156061, 16495860,
16139278, 14629299, 16669799, 11180255, 14667001, 6521816, 10435251, 1157897,
4617650, -4331274, -1901698, -9351922, -8132043, -13360950, -13126558, -15924694,
-16126224, -16765828, -16675178, -15793361, -14689995, -13112490, -10472367, -9013213,
-4663248, -3938954, 1854548, 1561391, 8090507, 6892836, 13096946, 11478667,
16113036, 14822823, 16680420, 16563560, 14712869, 16512580, 10509396, 14675393,
4708804, 11250736, -1807387, 6609060, -8048909, 1252467, -13067234, -4239608,
-16099725, -9273076, -16685532, -13303452, -14735629, -15894765, -10546345, -16766704,
-4754327, -15824948, 1760208, -13171372, 8007243, -9093019, 13037413, -4031052,
16086280, 1466963, 16690507, 6806294, 14758266, 11409370, 10583205, 14778269,
4799808, 16548569, -1713018, 16528772, -7965517, 14721017, -13007492, 11320857,
-16072711, 6696093, -16695352, 1346997, -14780790, -4147806, -10619985, -9193933,
-4845254, -13245529, 1665811, -15864327, 7923723, -16767044, 12977462, -15856030,
16059009, -13229833, 16700060, -9172535, 14803192, -4123022, 10656676, 1372488,
4890658, 6719533, -1618595, 11339709, -7881870, 14733243, -12947333, 16533048,
-16045183, 16544435, -16704639, 14766170, -14825480, 11390616, -10693285, 6782912,
-4936027, 1441484, 1571362, -4055872, 7839950, -9114496, 12917097, -13187183,
16031225, -15833382, 16709080, -16766849, 14847645, -15886605, 10729806, -13287870,
4981352, -9251757, -1524120, -4214859, -7797972, 1277970, -12886761, 6632558,
-16017143, 11269686, -16713391, 14687746, -14869695, 16516998, -10766244, 16559570,
-5026641, 14810851, 1476862, 11460011, 7755926, 6869513, 12856318, 1535925,
16002928, -3963808, 16717565, -9034768, 14891622, -13128415, 10802592, -15801931,
5071887, -16766117, -1429597, -15916671, -7713823, -13345483, -12825777, -9330684,
-15988590, -4306562, -16721609, 1183410, -14913435, 6545370, -10838858, 11199302,
-5117095, 14641779, 1382315, 16500421, 7671655, 16574175, 12795128, 14855059,
15974119, 11529039, 16725515, 6955896, 14935124, 1630316, 10875034, -3871617,
5162259, -8954750, -1335027, -13069226, -7629429, -15769975, -12764382, -16764849,
-15959525, -15946229, -16729292, -13402669, -14956697, -9409312, -10911126, -4398127,
-5207385, 1088813, 1287724, 6457974, 7587138, 11128560, 12733530, 14595343,
15944800, 16483315, 16732931, 16588250, 14978147, 14898792, 10947127, 11597699,
5252466, 7042055, -1240415, 1724656, -7544790, -3779303, -12702579, -8874447,
-15929951, -13009620, -16736440, -15737514, -14999482, -16763045, -10983045, -15975276,
-5297509, -13459426, 1193092, -9487639, 7502378, -4489552, 12671523, 994181,
15914971, 6370370, 16739812, 11057462, 15020692, 14548441, 11018871, 16465683,
5342506, 16601794, -1145763, 14942048, -7459910, 11665988, -12640370, 7127990,
-15899867, 1818940, -16743053, -3686867, -15041787, -8793859, -11054613, -12949598,
-5387463, -15704550, 1098421, -16760704, 7417378, -16003813, 12609112, -13515753,
15884632, -9565663, 16746157, -4580833, 15062757, 899517, 11090262, 6282563,
5432374, 10986010, -1051075, 14501074, -7374791, 16447524, -12577757, 16614808,
-15869275, 14984826, -16749131, 11733904, -15083611, 7213696, -11125827, 1913166,
-5477245, -3594314, 1003716, -8712991, 7332141, -12889162, 12546298, -15671083,
15853786, -16757828, 16751967, -16031838, 15104340, -13571647, 11161299, -9643381,
5522069, -4671968, -956353, 804824, -7289437, 6194556, -12514742, 10914207,
-15838175, 14453243, -16754673, 16428839, -15124952, 16627290, -11196685, 15027126,
-5566852, 11801444, 908978, 7299172, 7246670, 2007332, 12483082, -3501646,
15822433, -8631844, 16757241, -12828314, 15145440, -15637116, 11231978, -16754416,
5611587, -16059350, -861600, -13627108, -7203849, -9720791, -12451326, -4762953,
-15806569, 710105, -16759679, 6106350, -15165810, 10842055, -11267186, 14404950,
-5656281, 16409629, 814211, 16639241, 7160967, 15068944, 12419467, 11868607,
15790574, 7384415, 16761979, 2101432, 15186055, -3408866, 11302299, -8550420,
5700926, -12767055, -766820, -15602649, -7118032, -16750469, -12387513, -16086349,
-15774457, -13682133, -16764149, -9797890, -15206183, -4853786, -11337326, 615364,
-5745529, 6017948, 719418, 10769557, 7075035, 14356196, 12355455, 16389894,
15758210, 16650659, 16766181, 15110281, 15226185, 11935391, 11372258, 7469421,
5790083, 2195466, -672015, -3315976, -7031986, -8468724, -12323303, -12705388,
-15741841, -15567682, -16768083, -16745985, -15246070, -16112834, -11407103, -13736721,
-5834594, -9874676, 624602, -4944463, 6988877, 520603, 12291048, 5929355,
15725342, 10696714, 16769847, 14306984, 15265828, 16369635, 11441854, 16661545,
5879054, 15151135, -577189, 12001793, -6945716, 7554189, -12258699, 2289430,
-15708721, -3222981, -16771481, -8386756, -15285469, -12643315, -11476516, -15532218,
-5923471, -16740966, 529766, -16138803, 6902495, -13790869, 12226248, -9951145,
15691971, -5034983, 16772977, 425826, 15304983, 5840571, 11511083, 10623529,
5967837, 14257313, -482344, 16348852, -6859223, 16671898, -12193703, 15191504,
-15675099, 12067811, -16774343, 7638715, -15324379, 2383320, -11545562, -3129883,
-6012160, -8304520, 434914, -12580838, 6815893, -15496257, 12161057, -16735412,
15658098, -16164256, 16775571, -13844576, 15343649, -10027297, 11579945, -5125341,
6056430, 331034, -387484, 5751601, -6772511, 10550004, -12128317, 14207187,
-15640976, 16327547, -16776668, 16681719, -15362799, 15231388, -11614239, 12133443,
-6100656, 7722996, 340047, 2477134, 6729072, -3036684, 12095477, -8222019,
15623725, -12517958, 16777628, -15459801, 15381823, -16729322, 11648436, -16189192,
6144829, -13897840, -292611, -10103128, -6685583, -5215536, -12062544, 236233,
-15606353, 5662447, -16778457, 10476142, -15400728, 14156607, -11682544, 16305719,
-6188956, 16691005, 245169, 15270784, 6642037, 12198688, 12029510, 7807031,
15588852, 2570869, 16779148, -2943389, 15419506, -8139255, 11716554, -12454678,
6233031, -15422850, -197730, -16722698, -6598441, -16213611, -11996384, -13950660,
-15571230, -10178635, -16779709, -5305563, -15438165, 141424, -11750475, 5573113,
-6277059, 10401945, 150284, 14105573, 6554789, 16283370, 11963159, 16699758,
15553481, 15309691, 16780132, 12263542, 15456696, 7890816, 11784298, 2664521,
6321033, -2850000, -102842, -8056231, -6511088, -12391000, -11929842, -15385406,
-15535610, -16715539, -16780425, -16237510, -15475107, -14003034, -11818031, -10253817,
-6364961, -5395421, 55394, 46610, 6467332, 5483600, 11896425, 10327415,
15517612, 14054090, 16780580, 16260501, 15493391, 16707977, 11851664, 15348110,
6408833, 12328003, -7952, 7974348, -6423527, 2758089, -11862916, -2756518,
-15499492, -7972947, -16780604, -12326924, -15511557, -15347470, -11885210, -16707845,
-6452662, -16260892, -39499, -14054961, 6379666, -10328673, 11829310, -5485108,
15481246, -48206, 16780490, 5393910, 15529592, 10252554, 11918654, 14002155,
6496431, 16237111, 86942, 16715662, -6335759, 15386038, -11795613, 12392072,
-15462880, 8057627, -16780247, 2851569, -15547508, -2662949, -11952007, -7889411,
-6540153, -12262456, -134389, -15309043, 6291798, -16699617, 11761817, -16283752,
15444386, -14106437, 16779865, -10403197, 15565296, -5574618, 11985261, -143020,
6583819, 5304049, 181831, 10177367, -6247790, 13949774, -11727932, 16213202,
-15425773, 16722812, -16779353, 15423473, -15582963, 12455743, -12018423, 8140647,
-6627436, 2944956, -229275, -2569295, 6203729, -7805622, 11693949, -12197596,
15407033, -15270127, 16778702, -16690855, 15600501, -16306093, 12051484, -14157463,
6670997, -10477388, 276714, -5663950, -6159621, -237829, -11659876, 5214019,
-15388173, 10101854, -16777922, 13896946, -15617919, 16188775, -12084454, 16729427,
-6714508, 15460416, -324154, 12519017, 6115461, 8223406, 11625706, 3038250,
15369186, -2475559, 16777003, -7721583, 15635208, -12132345, 12117323, -15230723,
6757961, -16681560, 371588, -16327911, -6071255, -14208036, -11591447, -10551245,
-15350080, -5753101, -16775955, -332630, -15652376, 5123821, -12150099, 10026017,
-6801364, 13843675, -419023, 16163830, 6026997, 16735508, 11557091, 15496864,
15330848, 12581890, 16774768, 8305903, 15669415, 3131447, 12182774, -2381744,
6844709, -7637298, 466451, -12066706, -5982695, -15190831, -11522647, -16671731,
-15311497, -16349208, -16773451, -14258154, -15686333, -10624764, -12215355, -5842068,
-6888003, -427421, -513878, 5033460, 5938341, 9949860, 11488107, 13789960,
15292020, 16138369, 16771996, 16741053, 15703121, 15532816, 12247835, 12644360,
6931239, 8388134, 561298, 3224543, -5893943, -2287853, -11453479, -7552767,
-15272424, -12000682, -16770411, -15150454, -15719788, -16661369, -12280221, -16369982,
-6974422, -14307817, -608717, -10697943, 5849495, -5930848, 11418756, -522199,
15252702, 4942938, 16768688, 9873385, 15736325, 13735804, 12312505, 16112391,
7017546, 16746063, 656128, 15568272, -5805003, 12706427, -11383945, 8470097,
-15232863, 3317537, -16766835, -2193888, -15752740, -7467996, -12344694, -11934273,
-7060618, -15109592, -703537, -16650473, 5760462, -16390232, 11349039, -14357022,
15212897, -10770780, 16764844, -6019438, 15769026, -616959, 12376781, 4852258,
7103630, 9796594, 750936, 13681210, -5715878, 16085898, -11314047, 16750537,
-15192814, 15603230, -16762722, 12768086, -15785189, 8551790, -12408772, 3410424,
-7146588, -2099853, -798334, -7382986, 5671244, -11867483, 11278960, -15068247,
15172606, -16639046, 16760463, -16409958, 15801222, -14405768, 12440661, -10843273,
7189486, -6107836, 845721, -711700, -5626569, 4761422, -11243787, 9719490,
-15152280, 13626177, -16758074, 16058890, -15817133, 16754476, -12472454, 15637689,
-7232330, 12829338, -893105, 8633208, 5581845, 3503203, 11208520, -2005751,
15131829, -7297739, 16755547, -11800314, 15832913, -15026420, 12504143, -16627086,
7275112, -16429160, 940478, -14454053, -5537081, -10915419, -11173167, -6196039,
-15111261, -806418, -16752890, 4670435, -15848571, 9642075, -12535737, 13570709,
-7317840, 16031369, -987848, 16757879, 5492268, 15671648, 11137721, 12890180,
15090568, 8714351, 16750095, 3595869, 15864098, -1911585, 12567226, -7212259,
7360506, -11732767, 1035206, -14984113, -5447415, -16614595, -11102190, -16447836,
-15069759, -14501876, -16747170, -10987216, -15879502, -6284043, -12598619, -901110,
-7403117, 4579297, -1082559, 9564352, 5402515, 13514807, 11066566, 16003335,
15048825, 16760746, 16744107, 15705106, 15894775, 12950609, 12629907, 8795215,
7445664, 3688421, 1129900, -1817357, -5357576, -7126549, -11030858, -11664845,
-15027775, -14941327, -16740914, -16601573, -15909925, -16465986, -12661098, -14549236,
-7488156, -11058662, -1177236, -6371847, 5312589, -995774, 10995058, 4488014,
15006601, 9486323, 16737583, 13458473, 15924944, 15974790, 12692183, 16763077,
7530584, 15738062, 1224558, 13010624, -5267565, 8875797, -10959173, 3780854,
-14985311, -1723072, -16734123, -7040610, -15939840, -11596550, -12723172, -14898062,
-7572956, -16588019, -1271875, -16483609, 5222494, -14596130, 10923198, -11129754,
14963897, -6459447, 16730525, -1090406, 15954604, 4396587, 12754054, 9407991,
7615264, 13401709, 1319177, 15945734, -5177385, 16764873, -10887138, 15770514,
-14942367, 13070223, -16726797, 8956096, -15969245, 3873166, -12784839, -1628732,
-7657514, -6954447, -1366473, -11527884, 5132231, -14854322, 10850988, -16573935,
14920714, -16500706, 16722931, -14642557, 15983754, -11200490, 12815517, -6546840,
7699699, -1185002, 1413754, 4305020, -5087041, 9329357, -10814755, 13344516,
-14898945, 15916168, -16718936, 16766132, -15998139, 15802462, -12846097, 13129404,
-7741827, 9036109, -1461028, 3965355, 5041805, -1534339, 10778432, -6868061,
14877054, -11458849, 16714803, -14810106, 16012393, -16559322, 12876571, -16517275,
7783889, -14688516, 1508286, -11270868, -4996533, -6634024, -10742026, -1279561,
-14855048, 4213314, -16710541, 9250426, -16026522, 13286896, -12906945, 15886093,
-7825893, 16766854, -1555535, 15833905, 4951217, 13188165, 10705531, 9115832,
14832918, 4057417, 16706140, -1439898, 16040519, -6781456, 12937212, -11389448,
7867830, -14765417, 1602769, -16544178, -4905866, -16533315, -10668953, -14734006,
-14810675, -11340886, -16701611, -6720995, -16054392, -1374079, -12967380, 4121474,
-7909708, 9171198, -1649994, 13228851, 4860471, 15855510, 10632287, 16767041,
14788308, 15864841, 16696943, 13246505, 16068133, 9195264, 12997440, 4149349,
7951519, -1345410, 1697201, -6694633, -4815041, -11319683, -10595540, -14720256,
-14765828, -16528506, -16692147, -16548827, -16081749, -14779024, -13027400, -11410540,
-7993270, -6807752, -1744399, -1468553, 4769569, 4029503, 10558704, 9091678,
14743226, 13170384, 16687212, 15824420, 16095233, 16766692, 13057252, 15895270,
8034954, 13304421, 1791579, 9274402, -4724063, 4241148, -10521787, -1250879,
-14720509, -6607597, -16682149, -11249556, -16108592, -14674624, -13087004, -16512305,
-8076577, -16563810, -1838748, -14823570, 4678515, -11479830, 10484783, -6894291,
14697671, -1562980, 16676948, 3937402, 16121818, 9011866, 13116647, 13111495,
8118132, 15792824, 1885899, 16765806, -4632934, 15925191, -10447698, 13361911,
-14674720, 9353243, -16671618, 4332812, -16134919, -1156309, -13146189, -6520350,
-8159625, -11179069, -1933039, -14628522, 4587311, -16495576, 10410526, -16578263,
14651647, -14867641, 16666150, -11548753, 16147888, -6980610, 13175622, -1657357,
8201050, 3845176, 1980160, 8931767, -4541656, 13052187, -10373275, 15760722,
-14628461, 16764384, -16660553, 15954603, -16160731, 13418974, -13204954, 9431786,
-8242413, 4424337, -2027268, -1061701, 4495961, -6432893, 10335937, -11108225,
14605154, -14581953, 16654819, -16478320, 16173441, -16592186, 13234176, -14911238,
8283706, -11617307, 2074357, -7066706, -4450234, -1751681, -10298520, 3752826,
-14581735, 8851382, -16648956, 12992461, -16186026, 15728117, -13263296, 16762427,
-8324937, 15983504, -2121432, 13475608, 4404467, 9510026, 10261017, 4515721,
14558195, -967059, 16642956, -6345231, 16198477, -11037025, 13292306, -14534918,
8366097, -16460536, 2168487, -16605578, -4358669, -14954357, -10223436, -11685489,
-14534542, -7152575, -16636827, -1845949, -16210803, 3660357, -13321215, 8770714,
-8407195, 12932321, -2215529, 15695009, 4312832, 16759933, 10185769, 16011894,
14510769, 13531812, 16630561, 9587963, 16222995, 4606960, 13350012, -872387,
8448221, -6257367, 2262549, -10965473, -4266964, -14487417, -10148025, -16442226,
-14486884, -16618440, -16624165, -14996998, -16235062, -11753298, -13378707, -7238216,
-8489183, -1940158, -2309554, 3567770, 4221059, 8689765, 10110195, 12871766,
14462880, 15661399, 16617633, 16756903, 16246994, 16039773, 13407291, 13587582,
8530074, 9665593, 2356537, 4698052, -4175124, -777687, -10072289, -6169302,
-14438764, -10893570, -16610972, -14439454, -16258801, -16423391, -13435772, -16630770,
-8570901, -15039160, -2403506, -11820730, 4129151, -7323625, 10034298, -2034305,
14414528, 3475070, 16604174, 8608538, 16270474, 12810800, 13464141, 15627288,
8611655, 16753337, 2450451, 16067138, -4083149, 13642918, -9996231, 9742914,
-14390181, 4788994, -16597248, -682961, -16282021, -6081039, -13492407, -10821318,
-8652344, -14391029, -2497381, -16404030, 4037111, -16642568, 9958081, -15080841,
14365715, -11887785, 16590185, -7408800, 16293434, -2128387, 13520560, 3382258,
8692960, 8527036, 2544286, 12749424, -3991044, 15592678, -9919854, 16749236,
-14341138, 16093989, -16582993, 13697818, -16304720, 9819923, -13548610, 4879783,
-8733511, -588214, -2591176, -5992583, 3944942, -10748721, 9881544, -14342143,
14316443, -16384145, 16575665, -16653834, 16315872, -15122039, 13576548, -11954459,
8773988, -7493738, 2638040, -2222401, -3898812, 3289338, -9843160, 8445262,
-14291637, 12687641, -16568208, 15557569, -16326898, 16744599, -13604380, 16120326,
-8814399, 13752280, -2684888, 9896618, 3852646, 4970415, 9804692, -493448,
14266713, -5903934, 16560614, -10675779, 16337789, -14292799, 13632101, -16363736,
8854735, -16664568, 2731710, -15162754, -3806454, -12020752, -9766150, -7578437,
-14241679, -2316344, -16552893, 3196313, -16348553, 8363217, -13659716, 12625452,
-8895004, 15521962, -2778514, 16739427, 3760228, 16146148, 9727526, 13806302,
14216527, 9972997, 16545035, 5060889, 16359183, -398666, 13687218, -5815097,
8935198, -10602497, 2825292, -14242998, -3713975, -16342803, -9688829, -16674768,
-14191265, -15202985, -16537048, -12086660, -16369686, -7662893, -13714614, -2410213,
-8975325, 3103185, -2872051, 8280905, 3667689, 12562859, 9650049, 15485859,
14165886, 16733719, 16528926, 16171453, 16380054, 13859882, 13741897, 10049057,
9015376, 5151201, 2918784, -303872, -3621378, -5726074, -9611197, -10528875,
-14140398, -14192742, -16520675, -16321348, -16390296, -16684435, -13769074, -15242728,
-9055359, -12152181, -2965497, -7747104, 3575033, -2504005, 9572264, 3009959,
14114792, 8198328, 16512288, 12499864, 16400402, 15449261, 13796137, 16727476,
9095266, 16196241, 3012182, 13913019, -3528664, 10124796, -9533259, 5241348,
-14089078, -209068, -16503773, -5636868, -16410381, -10454917, -13823093, -14142031,
-9135104, -16299371, -3058847, -16693569, 3482263, -15281985, 9494173, -12217313,
14063247, -7831068, 16495123, -2597716, 16420225, 2916636, 13849936, 8115489,
9174865, 12436470, 3105484, 15412169, -3435838, 16720699, -9455015, 16220511,
-14037308, 13965711, -16486344, 10200210, -16429941, 5331327, -13876671, -114257,
-9214556, -5547482, -3152100, -10380624, 3389382, -14090869, 9415778, -16276873,
14011252, -16702169, 16477430, -15320752, 16439523, -12282055, 13903291, -7914780,
9254170, -2691344, 3198687, 2823221, -3342903, 8032391, -9376469, 12372678,
-13985089, 15374584, -16468388, 16713386, -16448976, 16244262, -13929804, 14017957,
-9293713, 10275298, -3245251, 5421135, 3296394, -19445, 9337084, -5457921,
13958811, -10306001, 16459210, -14039256, 16458295, -16253855, 13956204, -16710236,
9333182, -15359032, 3291790, -12346407, -3249856, -7998243, -9297622, -2784889,
-13932422, 2729713, -16449904, 7949035, -16467486, 12308489, -13982494, 15336507,
-9372575, 16705539, -3338301, 16267494, 3203296, 14069755, 9258086, 10350060,
13905920, 5510773, 16440464, 75373, 16476541, -5368179, 14008668, -10231045,
9411891, -13987193, 3384783, -16230316, -3156711, -16717767, -9218480, -15396818,
-13879310, -12410360, -16430895, -8081445, -16485468, -2878341, -14034735, 2636120,
-9451136, 7865426, -3431243, 12243909, 3110098, 15297940, 9178795, 16697158,
13852586, 16290206, 16421192, 14121103, 16494260, 10424489, 14060685, 5600232,
9490301, 170186, 3477670, -5278270, -3063464, -10155764, -9139042, -13934684,
-13825755, -16206258, -16411361, -16724764, -16502924, -15434112, -14086527, -12473917,
-9529394, -8164391, -3524074, -2971702, 3016801, 2542442, 9099211, 7781565,
13798809, 12178936, 16401395, 15258884, 16511451, 16688244, 14112252, 16312397,
9568407, 14171999, 3570446, 10498584, -2970118, 5689512, -9059312, 264993,
-13771757, -5188191, -16391302, -10080158, -16519851, -13881729, -14137869, -16181683,
-9607348, -16731226, -3616793, -15470913, 2923407, -12537076, 9019336, -8247075,
13744591, -3064968, 16381074, 2448683, 16528115, 7697455, 14163369, 12113574,
9646208, 15219340, 3663108, 16678795, -2876677, 16334066, -8979292, 14222441,
-13717319, 10572344, -16370718, 5778611, -16536250, 359792, -14188759, -5097947,
-9684995, -10004229, -3709397, -13828330, 2829920, -16156590, 8939172, -16737153,
13689933, -15507219, 16360228, -12599834, 16544250, -8329496, 14214032, -3158137,
9723700, 2354846, 3755652, 7613099, -2783144, 12047824, -8898985, 15179309,
-13662442, 16668813, -16349611, 16355213, -16552121, 14272430, -14239195, 10645766,
-9762332, 5867524, -3801881, 454579, 2736342, -5007539, 8858723, -9927981,
13634838, -13774489, 16338860, -16130980, 16559856, -16742545, 14264241, -15543029,
9800881, -12662189, 3848077, -8411651, -2689522, -3251204, -8818393, 2260933,
-13607129, 7528499, -16327982, 11981689, -16567462, 15138793, -14289176, 16658298,
-9839357, 16375837, -3894245, 14321961, 2642677, 10718848, 8777990, 5956250,
13579307, 549352, 16316969, -4916971, 16574932, -9851415, 14313993, -13720207,
9877749, -16104854, 3940378, -16747401, -2595814, -15578342, -8737520, -12724139,
-13551380, -8493536, -16305830, -3344167, -16582274, 2166948, -14338700, 7443659,
-9916067, 11915171, -3986484, 15097792, 2548927, 16647251, 8696976, 16395937,
13523341, 14371035, 16294556, 10791587, 16589479, 6044786, 14363288, 644107,
9954301, -4826246, 4032553, -9774534, -2502023, -13665487, -8656367, -16078214,
-13495198, -16751722, -16283156, -15613158, -16596555, -12785682, -14387765, -8575150,
-9992460, -3437024, -4078595, 2072893, 2455096, 7358581, 8615685, 11848272,
13466943, 15056309, 16271622, 16635670, 16603495, 16415513, 14412124, 14419649,
10030535, 10863980, 4124600, 6133128, -2408153, 738842, -8574937, -4735367,
-13438584, -9697341, -16259962, -13610329, -16610306, -16051059, -14436371, -16755508,
-10068533, -15647473, -4170576, -12846816, 2361186, -8656490, 8534117, -3529770,
13410114, 1978773, 16248168, 7273267, 16616980, 11780995, 14460498, 15014345,
10106448, 16623559, 4216514, 16434564, -2314205, 14467802, -8493233, 10936027,
-13381541, 6221274, -16236248, 833553, -16623525, -4644336, -14484514, -9619837,
-10144285, -13554737, -4262423, -16023391, 2267201, -16758757, 8452277, -15681289,
13352856, -12907540, 16224195, -8737553, 16629933, -3622404, 14508411, 1884589,
10182037, 7187721, 4308294, 11713340, -2220183, 14971900, -8411258, 16610915,
-13324069, 16453089, -16212015, 14515493, -16636213, 11007723, -14532195, 6309222,
-10219712, 928237, -4354135, -4553157, 2173143, -9542026, 8370167, -13498711,
13295172, -15995210, 16199702, -16761471, 16642355, -15714603, 14555859, -12967851,
10257302, -8818337, 4399936, -3714922, -2126090, 1790344, -8329013, 7101945,
-13266172, 11645311, -16187264, 14928976, -16648369, 16597740, -14579411, 16471088,
-10294813, 14562719, -4445706, 11079068, 2079016, 6396967, 8287789, 1022892,
13237062, -4461832, 16174692, -9463910, 16654245, -13442253, 14602842, -15966518,
10332238, -16763648, 4491437, -15747414, -2031929, -13027747, -8246502, -8898838,
-13207850, -3807321, -16161995, 1696043, -16659992, 7015942, -14626160, 11576909,
-10369584, 14885575, -4537136, 16584035, 1984822, 16488561, 8205146, 14609479,
13178529, 11150058, 16149164, 6484508, 16665602, 1117514, 14649358, -4370364,
10406843, -9385491, 4582795, -13385366, -1937703, -15937316, -8163728, -16765290,
-13149106, -15779722, -16136209, -13087226, -16671083, -8979055, -14672442, -3899598,
-10444024, 1601687, -4628421, 6929714, 1890565, 11508137, 8122240, 14841698,
13119575, 16569799, 16123120, 16505506, 16676426, 14655773, 14695405, 11220692,
10481116, 6571841, 4674006, 1212100, -1843415, -4278757, -8080692, -9306772,
-13089942, -13328050, -16109907, -15907604, -16681640, -16766395, -14718255, -15811526,
-10518129, -13146287, -4719558, -9058985, 1796247, -3991751, 8039075, 1507280,
13060201, 6843265, 16096560, 11438998, 16686717, 14797347, 14740983, 16555034,
10555054, 16521924, 4765068, 14701597, -1749069, 11290967, -7997398, 6658965,
-13030359, 1306647, -16083089, -4187013, -16691665, -9227755, -14763597, -13270309,
-10591898, -15877383, -4810543, -16766965, 1701872, -15842823, 7955653, -13204928,
13000409, -9138625, 16069486, -4083776, 16696474, 1412825, 14786089, 6756598,
10628654, 11369492, 4855977, 14752522, -1654666, 16539739, -7913848, 16537813,
-12970359, 14746952, -16055758, 11360880, -16701155, 6745875, -14808467, 1401153,
-10665329, -4095135, -4901375, -9148444, 1607443, -13212143, 7871977, -15846655,
12940202, -16766998, 16041898, -15873614, 16705698, -13263146, 14830722, -9217973,
10701915, -4175670, 4946731, 1318325, -1560210, 6669714, -7830046, 11299623,
-12909945, 14707226, -16027913, 16523915, -16710111, 16553174, -14852863, 14791835,
-10738418, 11430431, -4992050, 6832570, 1512962, 1495614, 7788048, -4003126,
12879581, -9068839, 16013796, -13153554, 16714387, -15815420, 14874881, -16766495,
10774833, -15903898, 5037326, -13320940, -1465705, -9297026, -7745993, -4267431,
-12849118, 1223783, -15999556, 6582616, -16718533, 11229393, -14896785, 14661459,
-10811165, 16507562, -5082566, 16568005, 1418432, 14836245, 7703871, 11499616,
12818548, 6919046, 15985183, 1590027, 16722542, -3910989, 14918565, -8988945,
10847406, -13094545, 5127761, -15783679, -1371153, -16765456, -7661692, -15933673,
-12787880, -13378308, -15970687, -9375782, -16726421, -4359055, -14940230, 1129201,
-10883565, 6495309, -5172919, 11158803, 1323858, 14615224, 7619447, 16490682,
12757105, 16582306, 15956059, 14880180, 16730162, 11568433, 14961771, 7005301,
10919633, 1684389, 5218032, -3818727, -1276556, -8908763, -7577146, -13035117,
-12726233, -15751433, -15941307, -16763880, -16733773, -15962938, -14983197, -13435249,
-10955617, -9454238, -5263107, -4450540, 1229241, 1034583, 7534780, 6407793,
12695254, 11087857, 15926424, 14568521, 16737247, 16473275, 15004499, 16596077,
10991510, 14923640, 5308136, 11636881, -1181919, 7091332, -7492358, 1778697,
-12664178, -3726343, -15911417, -8828297, -16740591, -12975272, -15025685, -15718684,
-11027320, -16761769, -5353126, -15991693, 1134584, -13491760, 7449872, -9532392,
12632998, -4541883, 15896280, 939932, 16743797, 6320073, 15046747, 11016556,
11063036, 14521352, 5398070, 16455340, -1087245, 16609317, -7407330, 14966623,
-12601720, 11704956, -15881019, 7177136, -16746873, 1872949, -15067693, -3633839,
-11098669, -8747548, -5442974, -12915013, 1039892, -15685432, 7364725, -16759122,
12570337, -16019937, 15865628, -13547839, 16749811, -9610241, 15088514, -4633080,
11134209, 845252, 5487831, 6232151, -992535, 10944903, -7322065, 14473719,
-12538858, 16436880, -15850113, 16622026, -16752619, 15009127, -15109219, 11772657,
-11169664, 7262711, -5532648, 1967140, 945166, -3541220, 7279343, -8666519,
12507274, -12854340, 15834468, -15651678, 16755290, -16755938, 15129799, -16047668,
11205025, -13603485, 5577417, -9687783, -897794, -4724130, -7236566, 750544,
-12475595, 6144029, -15818700, 10872899, -16757830, 14425623, -15150262, 16417894,
-11240301, 16634204, -5622146, 15051151, 850410, 11839982, 7193728, 7348053,
12443811, 2061269, 15802802, -3448487, 16760233, -8585213, 15170599, -12793257,
11275483, -15617424, 5666825, -16752219, -803023, -16074886, -7150836, -13658696,
-12411933, -9765015, -15786781, -4815028, -16762505, 655812, -15190820, 6055711,
-11310579, 10800549, -5711463, 14377066, 755627, 16398383, 7107883, 16645850,
12379951, 15092694, 15770631, 11906928, 16764640, 7433161, 15210915, 2155332,
11345580, -3355644, 5756051, -8503633, -708228, -12731764, -7064877, -15582670,
-12347874, -16747965, -15754358, -16101591, -16766644, -13713471, -15230893, -9841934,
-11380495, -4905772, -5800598, 561059, 660819, 5967199, 7021811, 10727852,
12315694, 14328049, 15737955, 16378347, 16768510, 16656963, 15250744, 15133754,
11415315, 11973493, 5845094, 7518031, -613409, 2249325, -6978693, -3262694,
-12283420, -8421781, -15721430, -12669864, -16770247, -15547419, -15270478, -16743174,
-11450048, -16127780, -5889547, -13767807, 565991, -9918539, 6935514, -4996360,
12251044, 466288, 15704776, 5878496, 16771845, 10654813, 15290086, 14278573,
11484685, 16357788, 5933949, 16667544, -518571, 15174330, -6892285, 12039675,
-12218574, 7602660, -15688000, 2343247, -16773313, -3169639, -15309575, -8339659,
-11519234, -12607559, -5978308, -15511670, 471144, -16737849, 6848996, -16153453,
12186002, -13821702, 15671095, -9994827, 16774644, -5086787, 15328938, 371502,
11553687, 5789605, 6022615, 10581433, -423717, 14228642, -6805656, 16336706,
-12153337, 16677592, -15654068, 15214421, -16775844, 12105472, -15348183, 7687046,
-11588052, 2437094, -6066878, -3076483, 376282, -8257271, 6762258, -12544851,
12120570, -15475425, 15636913, -16731988, 16776905, -16178610, 15367301, -13875156,
11622320, -10070795, 6111088, -5177052, -328849, 276705, -6718810, 5700530,
-12087711, 10507715, -15619636, 14178255, -16777837, 16315101, -15386300, 16687106,
-11656499, 15254025, -6155254, 12170882, 281408, 7771187, 6675305, 2530863,
12054751, -2983229, 15602230, -8174619, 16778631, -12481741, 15405172, -15438685,
11690581, -16725591, 6199366, -16203250, -233970, -13928166, -6631750, -10146441,
-12021699, -5267151, -15584704, 181898, -16779294, 5611272, -15423924, 10433660,
-11724573, 14127415, -6243432, 16292975, 186526, 16696087, 6588138, 15293142,
11988547, 12235903, 15567049, 7855079, 16779820, 2624551, 15442550, -2889879,
11758468, -8091706, 6287445, -12418233, -139084, -15401451, -6544477, -16718661,
-11955302, -16227371, -15549274, -13980730, -16780215, -10221762, -15461056, -5357082,
-11792273, 87086, -6331411, 5521834, 91637, 10359272, 6500760, 14076123,
11921959, 16270327, 15531370, 16704534, 16780472, 15331769, 15479434, 12300533,
11825979, 7938719, 6375323, 2718155, -44194, -2796437, -6456996, -8008534,
-11888524, -12354328, -15513347, -15363726, -16780599, -16711196, -15497692, -16250974,
-11859594, -14032847, -6419188, -10296757, -3256, -5446843, 6413172, -7731,
11854987, 5432218, 15495194, 10284551, 16780588, 14024380, 15515825, 16247159,
11893113, 16712447, 6462999, 15369907, 50699, 12364770, -6369305, 8022107,
-11821363, 2811673, -15476923, -2702904, -16780447, -7925104, -15533835, -12290026,
-11926539, -15325508, -6506761, -16703195, -98147, -16274057, 6325383, -14084517,
11787640, -10371423, 15458523, -5536428, 16780167, -102544, 15551717, 5342432,
11959866, 10209504, 6550467, 13972190, 145589, 16223472, -6281413, 16719825,
-11753826, 15407552, -15440004, 12428611, -16779757, 8105237, -15569480, 2905100,
-11993101, -2609287, -6594124, -7841422, -193035, -12225333, 6237390, -15286800,
11719915, -16694661, 15421358, -16296619, 16779210, -14135735, 15587114, -10445757,
12026236, -5625836, 6637725, -197355, 240475, 5252473, -6193320, 10134130,
-11685914, 13919553, -15402592, 16199267, -16778532, 16726669, -15604627, 15444706,
-12059279, 12492054, -6681276, 8188108, -287917, 2998435, 6149197, -2515585,
11651815, -7757490, 15383699, -12160248, 16777716, -15247604, 15622011, -16685593,
12092222, -16318661, 6724771, -14186501, 335353, -10519756, -6105029, -5715065,
-11617627, -292161, -15364688, 5162347, -16776769, 10058431, -15639275, 13866471,
-12125072, 16174543, -6768215, 16732977, -382790, 15481365, 6060808, 12555098,
11583342, 8270718, 15345549, 3091673, 16775685, -2421803, 15656409, -7673309,
12157821, -12094775, 6811602, -15207921, 430220, -16675992, -6016543, -16340180,
-11548969, -14236814, -15326292, -10593420, -16774471, -5804110, -15673423, -386956,
-12190477, 5072055, -6854938, 9982411, -477651, 13812945, 5972225, 16149301,
11514499, 16738751, 15306908, 15517529, 16773118, 12617741, 15690307, 8353062,
12223031, 3184813, 6898215, -2327944, 525073, -7588883, -5927864, -12028915,
-11479941, -15167751, -15287405, -16665857, -16771636, -16361177, -15707069, -14286672,
-12255492, -10666744, -6941441, -5892970, -572496, -481740, 5883451, 4981602,
11445288, 9906071, 15267777, 13758977, 16770015, 16123544, 15723702, 16743990,
12287851, 15553197, 6984608, 12679980, 619910, 8435140, -5838996, 3277851,
-11410546, -2234010, -15248030, -7504214, -16768264, -11962670, -15740214, -15127095,
-12320115, -16655190, -7027723, -16381651, -667323, -14336072, 5794489, -10739728,
11375710, -5981642, 15228158, -576508, 16766375, 4890988, 15756595, 9829415,
12352278, 13704570, 7070777, 16097271, 714727, 16748693, -5749940, 15588368,
-11340787, 12741814, -15208168, 8516948, -16764356, 3370784, -15772855, -2140005,
-12384345, -7419306, -7113779, -11896043, -762129, -15085957, 5705342, -16643990,
11305769, -16401601, 15188052, -14385014, 16762200, -10812368, 15788984, -6070123,
12416309, -671258, 7156721, 4800219, 809521, 9752444, -5660701, 13649724,
-11270665, 16070483, -15167819, 16752860, -16759913, 15623040, -15804992, 12803240,
-12448178, 8598484, -7199609, 3463609, -856911, -2045931, 5616012, -7334160,
11235466, -11829035, 15147461, -15044335, 16757488, -16632257, 15820868, -16421027,
12479944, -14433497, 7242435, -10884663, 904289, -6158409, -5571281, -765986,
-11200182, 4709296, -15126985, 9675162, -16754933, 13594442, -15836623, 16043181,
-12511613, 16756492, -7285208, 15657212, -951665, 12864257, 5526502, 8679745,
11164804, 3556324, 15106385, -1951792, 16752240, -7248779, 15852247, -11761649,
12543179, -15002233, 7327918, -16619993, 999029, -16439927, -5481683, -14481517,
-11129341, -10956609, -15085667, -6246499, -16749418, -860690, -15867748, 4618222,
-12574649, 9597570, -7370574, 13538725, -1046389, 16015366, 5436816, 16759588,
11093785, 15690884, 15064826, 12924862, 16746457, 8760728, 15883118, 3648925,
12606014, -1857590, 7413166, -7163167, 1093736, -11693886, -5391910, -14959651,
-11058145, -16607197, -15043867, -16458302, -16743366, -14529075, -15898365, -11028205,
-12637282, -6334388, -7455704, -955366, -1141079, 4527001, 5346956, 9519671,
11022412, 13482575, 15022785, 15987039, 16740138, 16762148, 15913481, 15724054,
12668445, 12985054, 7498178, 8841431, 1188408, 3741409, -5301964, -1763330,
-10986595, -7077325, -15001586, -11625750, -16736780, -14916590, -15928474, -16593870,
-12699511, -16476150, -7540596, -14576168, -1235733, -11099448, 5256925, -6422075,
10950686, -1050011, 14980264, 4435635, 16733284, 9441468, 15943336, 13425994,
12730471, 15958200, 7582949, 16764172, 1283043, 15756722, -5211849, 13044831,
-10914693, 8921851, -14958825, 3833773, -16729658, -1669012, -15958074, -6991258,
-12761334, -11557242, -7625246, -14873053, -1330347, -16580013, 5166726, -16493472,
10878609, -14622794, 14937264, -11170336, 16725895, -6509557, 15972681, -1144623,
12792090, 4344127, 7667479, 9362963, 1377636, 13368984, -5121567, 15928852,
-10842442, 16765660, -14915586, 15788885, -16722002, 13104191, -15987164, 9001986,
-12822748, 3926015, -7709653, -1574642, -1424918, -6904966, 5076362, -11488365,
10806185, -14829040, 14893786, -16565625, 16717971, -16510266, 16001515, -14668954,
12853300, -11240868, 7751763, -6596831, 1472185, -1239199, -5031121, 4252480,
-10769845, 9284158, -14871870, 13311546, -16713810, 15898994, -16015742, 16766611,
-12883753, 15820544, -7793814, 13163131, -1519444, 9081834, 4985835, 4018131,
10733415, -1480221, 14849832, -6818454, 16709512, -11419120, 16029837, -14784553,
12914099, -16550708, 7835799, -16526532, 1566687, -14714644, -4940514, -11311039,
-10696903, -6683893, -14827679, -1333735, -16705084, 4160697, -16043808, 9205057,
-12944346, 13253683, -7877725, 15868628, -1613922, 16767027, 4895149, 15851696,
10660302, 13221651, 14805403, 9161390, 16700519, 4110119, 16057647, -1385752,
12974485, -6731724, 7919584, -11349510, 1661139, -14739593, -4849749, -16535261,
-10623620, -16542270, -14783013, -14759863, -16695824, -11380849, -16071361, -6770742,
-13004525, -1428228, -7961384, 4068781, -1708348, 9125661, 4804307, 13195395,
10586848, 15837754, 14760501, 16766907, 16690992, 15882342, 16084943, 13279748,
13034456, 9240654, 8003116, 4201975, 1755538, -1291240, -4758830, -6644779,
-10549996, -11279538, -14737874, -14694161, -16686030, -16519286, -16098400, -16557479,
-13064288, -14804611, -8044789, -11450295, -1802719, -6857375, 4713311, -1522675,
10513056, 3976735, 14715126, 9045973, 16680931, 13136686, 16111725, 15806374,
13094011, 16766250, 8086393, 15912480, 1849881, 13337421, -4667758, 9319622,
-10476036, 4293697, -14692264, -1196686, -16675703, -6557621, -16124924, -11209204,
-13123633, -14648260, -8127936, -16502782, -1897033, -16572158, 4622164, -14848885,
10438927, -11519375, 14669281, -6943788, 16670337, -1617074, 16137991, 3884562,
13153146, 8965997, 8169410, 13077557, 1944165, 15774488, -4576537, 16765057,
-10401740, 15942109, -14646185, 13394666, -16664842, 9398293, -16150933, 4385282,
-13182558, -1102093, -8210824, -6470254, -1991285, -11138512, 4530869, -14601891,
10364465, -16485751, 14622967, -16586307, 16659210, -14892685, 16163742, -11588087,
13211861, -7029979, 8252167, -1711421, 2038386, 3792265, -4485169, 8885733,
-10327111, 13018009, -14599637, 15742098, -16653449, 16763328, -16176425, 15971228,
-13241062, 13451484, -8293448, 9476662, -2085475, 4476727, 4439429, -1007466,
10289671, -6382679, 14576186, -11067464, 16647550, -14555054, 16188976, -16468192,
13270154, -16599926, 8334660, -14936008, 2132543, -11656428, -4393658, -7115945,
-10252153, -1805713, -14552622, 3699846, -16641522, 8805185, -16201400, 12958045,
-13299143, 15709205, -8375808, 16761063, -2179597, 15999837, 4347848, 13507871,
10214548, 9554729, 14528938, 4568028, 16635358, -912806, 16213692, -6294901,
13328022, -10996062, 8416886, -14507752, 2226631, -16450107, -4302007, -16613014,
-10176866, -14978853, -14505142, -11724396, -16629064, -7201684, -16225857, -1899948,
-13356798, 3607310, -8457900, 8724356, -2273650, 12897667, 4256127, 15675809,
10139099, 16758262, 14481226, 16027934, 16622633, 13563827, 16237889, 9632490,
13385464, 4659183, 8498843, -818117, 2320648, -6206921, -4210218, -10924308,
-10101254, -14459986, -14457198, -16431496, -16616074, -16625571, -16249795, -15021220,
-13414027, -11791989, -8539722, -7287192, -2367630, -1994122, 4164270, 3514657,
10063325, 8643248, 14433050, 12836877, 16609378, 15641912, 16261568, 16754925,
13442478, 16055518, 8580528, 13619348, 2414590, 9709943, -4118294, 4750190,
-10025319, -723402, -14408791, -6118743, -16602553, -10852205, -16273214, -14411758,
-13470826, -16412359, -8621270, -16637596, -2461535, -15063106, 4072280, -11859206,
9987229, -7372468, 14384413, -2088232, 16595591, 3421893, 16284726, 8561863,
13499062, 12775676, 8661939, 15607514, 2508456, 16751053, -4026238, 16082589,
-9949064, 13674435, -14359924, 9787086, -16588500, 4841044, -16296112, -628664,
-13527195, -6030369, -8702543, -10779755, -2555361, -14363069, 3980160, -16392698,
9910814, -16649090, 14335316, -15104511, 16581273, -11926043, 16307363, -7457507,
13555215, -2182275, 8743073, 3329018, 2602241, 8480205, -3934054, 12714066,
-9872490, 15572618, -14310598, 16746644, -16573917, 16109146, -16318489, 13729084,
-13583131, 9863916, -8783537, 4931744, -2649105, -533906, 3887913, -5941802,
9834083, -10706960, 14285761, -14313920, 16566425, -16372512, 16329480, -16660051,
13610934, -15145432, 8823927, -11992498, 2695943, -7542309, -3841744, -2276249,
-9795600, 3236038, -14260814, 8398275, -16558805, 12652050, -16340344, 15537224,
-13638632, 16741700, -8864251, 16135188, -2742764, 13783294, 3795541, 9940430,
9757036, 5022286, 14235749, -439130, 16551048, -5853045, 16351074, -10633823,
13666218, -14264314, 8904499, -16351803, 2789559, -16670479, -3749311, -15185870,
-9718398, -12058571, -14210574, -7626869, -16543162, -2370150, -16361677, 3142954,
-13693698, 8316077, -8944681, 12589629, -2836336, 15501332, 3703048, 16736221,
9679678, 16160713, 14185282, 13837063, 16535141, 10016626, 16372145, 5112667,
13721064, -344341, 8984787, -5764101, 2883086, -10560346, -3656759, -14214252,
-9640884, -16330571, -14159880, -16680374, -16526991, -15225821, -16382486, -12124257,
-13748325, -7711185, -9024825, -2463974, -2929817, 3049769, 3610437, 8233613,
9602010, 12526806, 14134361, 15464946, 16518705, 16730207, 16392692, 16185722,
13775472, 13890389, 9064787, 10092502, 2976520, 5202885, -3564089, -249541,
-9563063, -5674973, -14108733, -10486531, -16510291, -14163735, -16402771, -16308817,
-13802513, -16689735, -9104680, -15265286, -3023204, -12189556, 3517710, -7795254,
9524035, -2557721, 14082988, 2956487, 16501741, 8150885, 16412715, 12463582,
13829440, 15428064, 9144497, 16723657, 3069859, 16210213, -3471306, 13943272,
-9484935, 10168056, -14057134, 5292936, -16493063, -154732, -16422532, -5585663,
-13856260, -10412380, -9184244, -14112765, -3116494, -16286541, 3424870, -16698563,
9445756, -15304262, 14031165, -12254465, 16484250, -7879074, 16432214, -2651385,
13882965, 2863111, 9223914, 8067897, 3163100, 12399959, -3378412, 15390689,
-9406505, 16716573, -14005087, 16234186, -16475308, 13995708, -16441768, 10243283,
-13909563, 5382818, -9263515, -59920, -3209685, -5496175, 3331922, -10337897,
9367175, -14061344, 13978893, -16263745, 16466231, -16706857, 16451187, -15342749,
13936045, -12318981, 9303035, -7962641, 3256238, -2744962, -3285411, 2769645,
-9327774, 7984653, -13952591, 12335941, -16457026, 15352822, -16460479, 16708955,
-13962424, 16257641, -9342492, 14047699, -3302776, 10318186, 3238864, 5472529,
9288292, 34897, 13926173, -5406510, 16447686, -10263083, 16469634, -14009473,
13988682, -16240428, 9381863, -16714617, 3349277, -15380746, -3192300, -12383106,
-9248743, -8045957, -13899648, -2838457, -16438218, 2676085, -16478662, 7901149,
-14014834, 12271526, -9421165, 15314464, -3395757, 16700802, 3145706, 16280574,
9209115, 14099237, 13873009, 10392755, 16428615, 5562063, 16487554, 129711,
14040870, -5316673, 9460388, -10187941, 3442206, -13957154, -3099091, -16216592,
-9169417, -16721842, -13846262, -15418251, -16418884, -12446833, -16496319, -8129013,
-14066798, -2931858, -9499540, 2582443, -3488631, 7817396, 3052447, 12206721,
9129642, 15275617, 13819401, 16692115, 16409018, 16302987, 16504947, 14150326,
14092610, 10466994, 9538611, 5651420, 3535024, 224521, -3005782, -5226666,
-9089799, -10112473, -13792433, -13904390, -16399025, -16192237, -16513448, -16728533,
-14118312, -15455263, -9577610, -12510162, -3581393, -8211809, 2959090, -3025165,
9049878, 2488719, 13765351, 7733392, 16388897, 12141525, 16521813, 15236281,
14143898, 16682894, 9616529, 16324879, 3627730, 14200963, -2912377, 10540897,
-9009889, 5740597, -13738163, 319323, -16378642, -5136492, -16530049, -10036682,
-14169375, -13851180, -9655374, -16167365, -3674041, -16734688, 2865638, -15491780,
8969824, -12573092, 13710861, -8294343, 16368252, -3118375, 16538150, 2394914,
14194735, 7649141, 9694139, 12075940, 3720319, 15196458, -2818879, 16673140,
-8929692, 16346249, -13683454, 14251145, -16357735, 10614464, -16546122, 5829590,
-14219985, 414116, -9732830, -5046154, -3766572, -9960570, 2772094, -13797528,
8889484, -16141976, 13655933, -16740309, 16347083, -15527803, 16553958, -12635619,
14245117, -8376612, 9771439, -3211486, 3812790, 2301033, -2725291, 7564645,
-8849208, 12009969,
};

int unit_test_asrc_stereo(int test_case) {
    int input_frequency;
    int output_frequency;
    int *expected_wave;
    int steps = 100;
    int old_time = 0;
    if (test_case == 8) {
        old_time = 172686;
        input_frequency = 96000;
        output_frequency = 48000;
        expected_wave = (int *)expected_wave_stereo_96_48;   // 0 FILTER_DEFS_ASRC_FIR_BL_ID
        steps = 200;
    } else if (test_case == 9) {
        old_time = 866676;
        input_frequency = 176400;
        output_frequency = 176400;
        expected_wave = (int *)expected_wave_stereo_176_176;
        steps = 1000;
    } else {
        printf("Bad test case %d\n", test_case);
        return 1;
    }

    asrc_state_t sASRCState[LOCAL_SRC_CHANNELS_PER_INSTANCE];                                   // ASRC state machine state
    int iASRCStack[LOCAL_SRC_CHANNELS_PER_INSTANCE][ASRC_STACK_LENGTH_MULT * SRC_N_IN_SAMPLES * 100]; // Buffer between filter stages
    asrc_ctrl_t sASRCCtrl[LOCAL_SRC_CHANNELS_PER_INSTANCE];                                     // Control structure
    asrc_adfir_coefs_t asrc_adfir_coefs;                                                  // Adaptive filter coefficients

    uint64_t fs_ratio = 0;
    int sine_cnt = 0;
    int sine2_cnt = 0;

    int inputFsCode = fs_code(input_frequency);
    int outputFsCode = fs_code(output_frequency);

    for(int ui = 0; ui < LOCAL_SRC_CHANNELS_PER_INSTANCE; ui++)
    {
            // Set state, stack and coefs into ctrl structure
            sASRCCtrl[ui].psState                   = &sASRCState[ui];
            sASRCCtrl[ui].piStack                   = iASRCStack[ui];
            sASRCCtrl[ui].piADCoefs                 = asrc_adfir_coefs.iASRCADFIRCoefs;
    }

    fs_ratio = asrc_init(inputFsCode, outputFsCode, sASRCCtrl, LOCAL_SRC_CHANNELS_PER_INSTANCE, SRC_N_IN_SAMPLES, SRC_DITHER_SETTING);
    fs_ratio *= 0.9991;
    int in_samples[4][LOCAL_SRC_CHANNELS_PER_INSTANCE];
    int out_samples[20][LOCAL_SRC_CHANNELS_PER_INSTANCE];
    int exp_cnt = 0;
    int errors = 0;
    int total_time = 0, t0, t1;
    for(int32_t i = 0; i < steps; i+=4) {
        for(int j = 0; j < 4; j++) {
            in_samples[j][0] = sine_wave[sine_cnt];
            sine_cnt++;
            if (sine_cnt == 16) sine_cnt = 0;
            in_samples[j][1] = sine2_wave[sine2_cnt];
            sine2_cnt++;
            if (sine2_cnt == 19) sine2_cnt = 0;
        }
        asm volatile("gettime %0" : "=r" (t0));
        int num_samples = asrc_process((int *)in_samples, (int *) out_samples, fs_ratio, sASRCCtrl);
        asm volatile("gettime %0" : "=r" (t1));
        total_time += t1-t0;
        for(int j = 0; j < num_samples; j++) {
            for(int k = 0; k < 2; k++) {
                int idx = exp_cnt*LOCAL_SRC_CHANNELS_PER_INSTANCE+k;
                if (abs(out_samples[j][k] - expected_wave[idx]) > 8) {
                    printf("saw %d expected %d\n", out_samples[j][k], expected_wave[idx]);
                    errors++;
                }
            }
            exp_cnt++;
        }
    }
    printf("%d -> %d stereo: %d errors time %d old_time %d %f speedup\n", input_frequency, output_frequency, errors, total_time, old_time, old_time / (float) total_time);
    return errors;
}

#define ONE  0x1000000

int unit_test_fir() {
    int        DWORD_ALIGNED piData[64]  = {
        1*ONE, 2*ONE, 4*ONE, 8*ONE, -1*ONE, -8*ONE, -4*ONE, -9*ONE+6,
        1*ONE, 2*ONE, 4*ONE, 8*ONE, -4*ONE, -8*ONE, -4*ONE+3, -9*ONE,
        1*ONE, 2*ONE, 4*ONE, 8*ONE, -1*ONE, -1*ONE-12345, -4*ONE, -9*ONE,
        1*ONE, 2*ONE, 4*ONE, 8*ONE, -1*ONE, -8*ONE, -5*ONE, -9*ONE,
        4*ONE, 2*ONE, 4*ONE, 8*ONE, -1*ONE, -8*ONE, -4*ONE, -9*ONE,
        1*ONE, -3*ONE, 4*ONE, 8*ONE, -4*ONE, -8*ONE, -4*ONE, -9*ONE,
        1*ONE, 2*ONE, 1*ONE, 8*ONE, -1*ONE, -1*ONE, -4*ONE, -9*ONE,
        1*ONE, 2*ONE, 4*ONE, -7*ONE, -1*ONE, -8*ONE, -5*ONE, -9*ONE,
    };
    int        DWORD_ALIGNED piCoefs[64] = {
        ONE, 2*ONE,
        -1*ONE, -3*ONE,
        5*ONE, 7*ONE,
        8*ONE, -7*ONE,
        ONE, 2*ONE,
        -1*ONE, -3*ONE,
        5*ONE, 7*ONE,
        8*ONE, -9*ONE,

        ONE, 5*ONE,
        -5*ONE, -3*ONE,
        5*ONE, 7*ONE,
        8*ONE, -7*ONE,
        ONE, 2*ONE,
        -1*ONE, -3*ONE,
        5*ONE, 7*ONE,
        8*ONE, -8*ONE,

        ONE, 5*ONE,
        -5*ONE, -3*ONE,
        5*ONE, 7*ONE,
        8*ONE, -7*ONE,
        ONE, 2*ONE,
        -1*ONE, -3*ONE,
        6*ONE, 1*ONE,
        9*ONE, -8*ONE,
    
        ONE, 5*ONE,
        -5*ONE, -3*ONE,
        5*ONE, 7*ONE,
        2*ONE, -7*ONE,
        ONE, 2*ONE,
        -1*ONE, -3*ONE,
        5*ONE, 7*ONE,
        8*ONE, -1*ONE
    };
    int        DWORD_ALIGNED piCoefs2[64] = {
        ONE, -1*ONE, 5*ONE, 8*ONE, ONE, -1*ONE, 5*ONE, 8*ONE,
        2*ONE, -3*ONE, 7*ONE, -7*ONE, 2*ONE, -3*ONE, 7*ONE,  -9*ONE,
        ONE, -5*ONE, 5*ONE, 8*ONE, ONE, -1*ONE, 5*ONE, 8*ONE,
        5*ONE, -3*ONE, 7*ONE, -7*ONE, 2*ONE, -3*ONE, 7*ONE,  -8*ONE,
        ONE, -5*ONE, 5*ONE, 8*ONE, ONE, -1*ONE, 6*ONE, 9*ONE,
        5*ONE, -3*ONE, 7*ONE, -7*ONE, 2*ONE, -3*ONE, 1*ONE,  -8*ONE,
        ONE, -5*ONE, 5*ONE, 2*ONE, ONE, -1*ONE, 5*ONE, 8*ONE,
        5*ONE, -3*ONE, 7*ONE, -7*ONE, 2*ONE, -3*ONE, 7*ONE,  -1*ONE,
    };
    for(int i = 0; i < 64; i++) {
        int o = (i&1) * 8 + (i&~15) + (i&14)/2;
//        printf("%08x  %08x\n", piCoefs
        piCoefs2[o] = piCoefs[i];
    }
    int        DWORD_ALIGNED        iData1[2];
    int        DWORD_ALIGNED        iData2[2];

    iData1[0] = 0x1234;
    iData1[1] = 0x2234;
    iData2[0] = 0x3234;
    iData2[1] = 0x4234;
    int t0, t1, t2, t3;
    int errors = 0;
    asm volatile("gettime %0" : "=r" (t0));
    src_mrhf_fir_os_inner_loop_asm(piData, piCoefs, iData1, 16);
    asm volatile("gettime %0" : "=r" (t1));
    printf("Fir os inner loop: time old %d  ", t1-t0);
    asm volatile("gettime %0" : "=r" (t2));
    src_mrhf_fir_os_inner_loop_asm_xs3(piData, piCoefs2, iData2, 16);
    asm volatile("gettime %0" : "=r" (t3));
    printf(" new %d speedup %f\n", t3-t2, (t1-t0)/(float)(t3-t2));
    if (abs(iData1[0] - iData2[0]) > 2 || abs(iData1[1] - iData2[1]) > 2) {
        printf("expected %08x %08x ", iData1[0], iData1[1]);
        printf("saw %08x %08x\n", iData2[0], iData2[1]);
        errors++;
    }
    asm volatile("gettime %0" : "=r" (t0));
    src_mrhf_fir_inner_loop_asm(piData, piCoefs, iData1, 32);
    asm volatile("gettime %0" : "=r" (t1));
    printf("fir_inner_loop time old %d    ", t1-t0);
    asm volatile("gettime %0" : "=r" (t2));
    src_mrhf_fir_inner_loop_asm_xs3(piData, piCoefs, iData2, 32);
    asm volatile("gettime %0" : "=r" (t3));
    printf(" new %d speedup %f\n", t3-t2, (t1-t0)/(float)(t3-t2));
    if (abs(iData1[0] - iData2[0]) > 1) {
        printf("expected %08x", iData1[0]);
        printf("  saw %08x \n", iData2[0]);
        errors++;
    }

    asm volatile("gettime %0" : "=r" (t0));
    src_mrhf_adfir_inner_loop_asm(piData, piCoefs, iData1, 32);
    asm volatile("gettime %0" : "=r" (t1));
    printf("adfir_inner_loop time old %d   ", t1-t0);
    asm volatile("gettime %0" : "=r" (t2));
    src_mrhf_adfir_inner_loop_asm_xs3(piData, piCoefs, iData2, 32);
    asm volatile("gettime %0" : "=r" (t3));
    printf(" new %d speedup %f\n", t3-t2, (t1-t0)/(float)(t3-t2));
    if (abs(iData1[0] - iData2[0]) > 1) {
        printf("expected %08x", iData1[0]);
        printf("  saw %08x \n", iData2[0]);
        errors++;
    }
    return errors;
}


int main(void) {
    int errors = 0;
    errors += unit_test_spline();
    errors += unit_test_fir();
    errors += unit_test_asrc(0);
    errors += unit_test_asrc(1);
    errors += unit_test_asrc(2);
    errors += unit_test_asrc(3);
    errors += unit_test_asrc(4);
    errors += unit_test_asrc(5);
    errors += unit_test_asrc(6);
    errors += unit_test_asrc(7);
    errors += unit_test_asrc(8);
    errors += unit_test_asrc_stereo(8);
    errors += unit_test_asrc_stereo(9);

    if (errors == 0) {
        printf("PASS\n");
    } else {
        printf("FAIL: %d errors\n", errors);
    }

}


